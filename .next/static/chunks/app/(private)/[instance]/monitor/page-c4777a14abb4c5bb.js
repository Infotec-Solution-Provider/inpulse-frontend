(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8892],{3099:(e,t,s)=>{"use strict";function l(e){return e?("string"==typeof e&&(e=new Date(e)),!(e instanceof Date)||isNaN(e.getTime()))?"N/D":e.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"N/D"}s.d(t,{A:()=>l})},5180:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>u,uk:()=>c});var l=s(95155),a=s(12115),r=s(88702),n=s(40931),i=s(98892);let o={categories:{showCustomerChats:!0,showInternalChats:!0,showInternalGroups:!0,showSchedules:!0},user:"all",showBots:!1,showOngoing:!0,showFinished:!0,showOnlyScheduled:!1,startedAt:{from:null,to:null},finishedAt:{from:null,to:null},scheduledAt:{from:null,to:null},scheduledTo:{from:null,to:null},scheduledBy:"all",scheduledFor:"all"},d=(0,a.createContext)({});function c(e){let{children:t}=e,{monitorChats:s,getChatsMonitor:c,getMonitorSchedules:u,monitorSchedules:h}=(0,r.jb)(),{monitorInternalChats:m,getInternalChatsMonitor:x}=(0,n.Ay)(),{token:p}=(0,a.useContext)(i.c);(0,a.useEffect)(()=>{p&&(u(),c(),x())},[c,x,u,p]);let[f,g]=(0,a.useState)(o),v=(0,a.useMemo)(()=>{let e=m.filter(e=>{if(e.isGroup&&!f.categories.showInternalGroups||!e.isGroup&&!f.categories.showInternalChats||"all"!==f.user&&!e.participants.some(e=>e.userId===f.user)||f.showOnlyScheduled)return!1;let t=new Date(e.startedAt);return!(f.startedAt.from&&t<new Date(f.startedAt.from)||f.startedAt.to&&t>new Date(f.startedAt.to))});return[...e,...s.filter(e=>{var t,s,l,a;if(!f.categories.showCustomerChats||"all"!==f.user&&e.userId!==f.user||!f.showBots&&null!==e.botId||f.showOnlyScheduled&&!e.isSchedule)return!1;let r=null===e.finishedAt&&null!==e.startedAt,n=null!==e.finishedAt;return!(!f.showOngoing&&!f.showFinished||f.showOngoing&&!f.showFinished&&!r||!f.showOngoing&&f.showFinished&&!n||f.startedAt.from&&new Date(e.startedAt)<new Date(f.startedAt.from)||f.startedAt.to&&new Date(e.startedAt)>new Date(f.startedAt.to)||f.finishedAt.from&&e.finishedAt&&new Date(e.finishedAt)<new Date(f.finishedAt.from)||f.finishedAt.to&&e.finishedAt&&new Date(e.finishedAt)>new Date(f.finishedAt.to)||f.scheduledAt.from&&(null===(t=e.schedule)||void 0===t?void 0:t.scheduledAt)&&new Date(e.schedule.scheduledAt)<new Date(f.scheduledAt.from)||f.scheduledAt.to&&(null===(s=e.schedule)||void 0===s?void 0:s.scheduledAt)&&new Date(e.schedule.scheduledAt)>new Date(f.scheduledAt.to)||f.scheduledTo.from&&(null===(l=e.schedule)||void 0===l?void 0:l.scheduleDate)&&new Date(e.schedule.scheduleDate)<new Date(f.scheduledTo.from)||f.scheduledTo.to&&(null===(a=e.schedule)||void 0===a?void 0:a.scheduleDate)&&new Date(e.schedule.scheduleDate)>new Date(f.scheduledTo.to))}),...h.filter(e=>!(!f.categories.showSchedules||"all"!==f.scheduledBy&&e.scheduledBy!==f.scheduledBy||"all"!==f.scheduledFor&&e.scheduledFor!==f.scheduledFor||f.scheduledAt.from&&new Date(e.scheduledAt)<new Date(f.scheduledAt.from)||f.scheduledAt.to&&new Date(e.scheduledAt)>new Date(f.scheduledAt.to)))].sort((e,t)=>{let s=e=>new Date("startedAt"in e&&e.startedAt?e.startedAt:"scheduledAt"in e&&e.scheduledAt?e.scheduledAt:0),l=s(e),a=s(t);return l.getTime()-a.getTime()})},[s,m,f]);return(0,l.jsx)(d.Provider,{value:{chats:v,filters:f,setFilters:g,resetFilters:()=>{g(o)}},children:t})}function u(){let e=(0,a.useContext)(d);if(!e)throw Error("useMonitorContext must be used within a MonitorProvider");return e}},10576:(e,t,s)=>{"use strict";s.d(t,{A:()=>I});var l=s(95155),a=s(12115),r=s(88702),n=s(40931),i=s(98892),o=s(17245),d=s(69926),c=s(39447);function u(e){return e.from.startsWith("system")?"system":e.from.startsWith("me:")||e.from.startsWith("bot:")?"sent":"received"}function h(){let{currentChatMessages:e,currentChat:t}=(0,r.jb)(),{getMessageById:s,handleQuoteMessage:n}=(0,a.useContext)(c.U),{instance:h}=(0,a.useContext)(i.c),m="nunes"===h?(()=>{let t=[...e].map(e=>{var t;return!!("system"===e.from&&(null===(t=e.body)||void 0===t?void 0:t.startsWith("Atendimento transferido")))}).lastIndexOf(!0);return -1!==t?e.slice(t):e})():e;return(0,l.jsx)(l.Fragment,{children:m.map(e=>{let a=e.contactId&&e.quotedId&&s(e.contactId,e.quotedId),r=a?(0,o.A)(a,u(a),[],t):null;return(0,l.jsx)(d.Ay,{id:e.id,style:u(e),text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,quotedMessage:r,onQuote:()=>{n(e)}},"message_".concat(e.id))})})}var m=s(74205),x=s(86080),p=s(56204),f=s(68534),g=s(700),v=s(56278),j=s(54492),A=s(3127),b=s(99927),w=s(63148),y=s(65528),N=s(22376),C=s(85222),D=s(69242);function T(){let{currentInternalChatMessages:e,users:t,sendInternalMessage:s}=(0,a.useContext)(n.xI),{getMessageById:r,handleQuoteMessage:d}=(0,a.useContext)(c.U),{user:u}=(0,i.Z)(),{contacts:h}=(0,a.useContext)(p.Jj),[m,T]=(0,a.useState)(new Set),[I,k]=(0,a.useState)(!1),[O,S]=(0,a.useState)(null),[E,F]=(0,a.useState)(30),G=(0,a.useMemo)(()=>{let e=new Map;for(let s of t)e.set(s.CODIGO,s);return e},[t]),M=(0,a.useMemo)(()=>{let e=new Map;for(let s of h){var t;let l=null===(t=s.phone)||void 0===t?void 0:t.replace(/\D/g,"");l&&e.set(l,s.name)}return e},[h]),z=(0,a.useMemo)(()=>{var e,s;let l=new Map;for(let s of t){let t=null===(e=s.WHATSAPP)||void 0===e?void 0:e.replace(/\D/g,"");t&&l.set(t,s.NOME)}for(let e of h){let t=null===(s=e.phone)||void 0===s?void 0:s.replace(/\D/g,"");t&&!l.has(t)&&l.set(t,e.name)}return l},[t,h]),W=(0,a.useCallback)(e=>{T(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),U=()=>{T(new Set)},_=(0,a.useMemo)(()=>e.filter(e=>m.has(e.id)),[e,m]),P=(0,a.useMemo)(()=>e.slice(-E),[e,E]);function B(e,t){return"system"===e.from?"system":e.from==="user:".concat(t)?"sent":"received"}let q=e=>{for(let l of O||_){var t;s({chatId:e,text:l.body,fileId:null!==(t=l.fileId)&&void 0!==t?t:void 0,sendAsAudio:!1,sendAsDocument:!1,mentions:[],quotedId:null})}k(!1),S(null),U()},R=e=>{S([e]),k(!0)};return(0,l.jsxs)("div",{className:"relative h-full overflow-y-auto p-2",children:[E<e.length&&(0,l.jsx)("div",{className:"flex justify-center mb-2",children:(0,l.jsx)(f.A,{variant:"outlined",size:"small",onClick:()=>F(t=>Math.min(t+30,e.length)),children:"Carregar mais"})}),m.size>0&&(0,l.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 shadow p-2 flex items-center justify-between",children:[(0,l.jsxs)(g.A,{variant:"subtitle1",component:"div",children:[m.size," mensagem(s) selecionada(s)"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(f.A,{variant:"outlined",onClick:U,children:"Cancelar"}),(0,l.jsx)(f.A,{variant:"contained",onClick:()=>k(!0),children:"Encaminhar"})]})]}),(0,l.jsx)("ul",{className:"flex flex-col gap-2 pt-[48px]",children:P.map((e,s,a)=>{let n=e.internalChatId&&e.quotedId&&r(e.internalChatId,e.quotedId,!0),i=n?(0,o.A)(n,B(n,u.CODIGO),t,null,M):null,c=s>0?a[s-1]:null,h=!c||c.from!==e.from,p=null;if(e.from.startsWith("user:")){let t=Number(e.from.split(":")[1]),s=G.get(t);p=s?s.NOME:null}if(e.from.startsWith("external:")){let t=e.from.split(":"),s="";3===t.length?s=t[2]:2===t.length&&(s=t[1]);let l=s.split("@")[0].replace(/\D/g,""),a=G.get(l);if(a)p=a.NOME;else{let e=M.get(l);p=e||(l?(l.length,l):"Sem n\xfamero")}}return(0,l.jsx)(x.A,{id:e.id,style:B(e,u.CODIGO),groupFirst:h,sentBy:p||"Desconhecido",text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,quotedMessage:i,onQuote:()=>d(e),mentionNameMap:z,isForwardMode:m.size>0,isSelected:m.has(e.id),onSelect:W,onForward:()=>R(e),onCopy:()=>navigator.clipboard.writeText(e.body)},e.id)})}),(0,l.jsxs)(v.A,{open:I,onClose:()=>k(!1),maxWidth:"xs",fullWidth:!0,children:[(0,l.jsxs)(j.A,{children:["Encaminhar para...",(0,l.jsx)(A.A,{"aria-label":"fechar",onClick:()=>k(!1),sx:{position:"absolute",right:8,top:8},children:(0,l.jsx)(D.A,{})})]}),(0,l.jsx)(b.A,{dividers:!0,children:(0,l.jsx)(w.A,{children:t.map(e=>(0,l.jsx)(y.Ay,{disablePadding:!0,children:(0,l.jsx)(N.A,{onClick:()=>q(e.CODIGO),children:(0,l.jsx)(C.A,{primary:e.NOME,secondary:e.EMAIL||e.WHATSAPP})})},e.CODIGO))})})]})]})}function I(){let{currentChatMessages:e,currentChat:t}=(0,a.useContext)(r.ce),{currentInternalChatMessages:s}=(0,a.useContext)(n.xI),{user:o}=(0,a.useContext)(i.c),d=(null==t?void 0:t.chatType)==="wpp",c=(null==t?void 0:t.chatType)==="internal"&&!t.isGroup,u=(null==t?void 0:t.chatType)==="internal"&&t.isGroup,x=(0,a.useRef)(null),p=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(p.current){let e=setTimeout(()=>{var e;null===(e=p.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},100);return()=>clearTimeout(e)}},[null==t?void 0:t.id]),(0,l.jsx)(l.Fragment,{children:o&&(0,l.jsxs)("ul",{className:"flex flex-col flex-1 w-full gap-2 scrollbar-whatsapp bg-slate-300 dark:bg-slate-700 p-2 min-h-[calc(100vh-165px)] md:mt-0 mt-7 overflow-y-auto",ref:x,children:[d&&(0,l.jsx)(h,{}),c&&(0,l.jsx)(m.A,{}),u&&(0,l.jsx)(T,{}),(0,l.jsx)("li",{ref:p,className:"h-0"})]})})}},26317:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>V});var l=s(95155),a=s(12115),r=s(42663),n=s(58674),i=s(51922),o=s(93408);function d(e){let{type:t="external-chat",startDate:s,endDate:a,userName:d,sectorName:c="Suporte",imageUrl:u,chatTitle:h="Diego Souza",customerName:m,contactNumber:x,customerDocument:p,scheduledAt:f=null,scheduledFor:g=null,isScheduled:v=!1,participants:j,groupName:A,groupDescription:b,handleTransfer:w,handleView:y,handleFinish:N}=e,C={"external-chat":"violet","internal-chat":"cyan","internal-group":"green","scheduled-chat":"amber",schedule:"orange"};return(0,l.jsxs)("div",{className:"mb-2 w-full rounded-md bg-slate-200 dark:bg-slate-800",children:[(0,l.jsx)("div",{className:"".concat("bg-".concat(C[t],"-700/5")," py-2 pl-2 pr-4 text-slate-700 dark:text-slate-200"),children:(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)("div",{className:"w-48 border-l-[3px] ".concat("border-".concat(C[t],"-500")," px-2 text-xs"),children:[(0,l.jsx)("span",{className:"font-bold ".concat("text-".concat(C[t],"-800 dark:text-").concat(C[t],"-200")," "),children:{"external-chat":"Atendimento","scheduled-chat":"Atendimento Agendado","internal-chat":"Conversa Interna","internal-group":"Grupo Interno",schedule:"Agendamento"}[t]}),(0,l.jsx)("span",{className:"block",children:s||"N\xe3o Iniciado"}),(0,l.jsx)("span",{className:"block",children:a||(s?"Em andamento":(0,l.jsx)("br",{}))}),(0,l.jsxs)("span",{className:"block font-semibold text-indigo-800 dark:text-indigo-200",children:[" ",c&&(0,l.jsxs)(l.Fragment,{children:["(",c,") "]}),d||"N/A"," "]})]}),(0,l.jsx)(r.A,{alt:h,src:u||"",sx:{width:72,height:72},variant:"square"}),("external-chat"===t||"scheduled-chat"===t||"schedule"===t)&&(0,l.jsxs)("div",{className:"flex w-52 flex-col text-xs",children:[(0,l.jsxs)("span",{className:"text-md font-semibold",children:[h," "]}),(0,l.jsx)("span",{children:x||"N/A"}),m&&(0,l.jsx)("span",{children:m}),p&&(0,l.jsx)("span",{children:p})]}),"internal-chat"===t&&(0,l.jsx)("div",{className:"flex w-52 flex-col text-xs",children:(0,l.jsxs)("span",{className:"text-md font-semibold",children:[h," "]})}),"internal-group"===t&&(0,l.jsxs)("div",{className:"flex w-52 flex-col text-xs",children:[(0,l.jsxs)("span",{className:"text-md font-semibold",children:[A," "]}),(0,l.jsx)("p",{className:"truncate",children:b||"Sem descri\xe7\xe3o"}),(0,l.jsxs)("span",{children:[null==j?void 0:j.length," participantes"]})]}),v&&(0,l.jsxs)("div",{className:"flex w-52 flex-col border-l border-slate-400 text-xs pl-2",children:[(0,l.jsx)("span",{className:"font-semibold",children:"Agendado em"}),(0,l.jsx)("span",{children:f}),(0,l.jsx)("span",{className:"font-semibold",children:"Agendado para"}),(0,l.jsx)("span",{children:g})]}),(0,l.jsxs)("div",{className:"ml-auto flex flex-col items-end",children:[y&&(0,l.jsx)("button",{className:"hover:scale-125 hover:opacity-75",onClick:y,title:"Visualizar","aria-label":"Visualizar",children:(0,l.jsx)(n.A,{color:"info",className:"!text-sm"})}),w&&(0,l.jsx)("button",{className:"hover:scale-125 hover:opacity-75",onClick:w,title:"Transferir","aria-label":"Transferir",children:(0,l.jsx)(o.A,{color:"primary",className:"!text-sm"})}),N&&(0,l.jsx)("button",{className:"hover:scale-125 hover:opacity-75",onClick:N,title:"Finalizar","aria-label":"Finalizar",children:(0,l.jsx)(i.A,{color:"success",className:"!text-sm"})})]})]})}),(0,l.jsx)("div",{className:"hidden border-amber-500 border-cyan-500 border-green-500 border-violet-500 border-orange-500 bg-amber-700/5 bg-cyan-700/5 bg-green-700/5 bg-violet-700/5 bg-orange-700/5 text-amber-800 text-cyan-800 text-green-800 text-violet-800 dark:text-amber-200 dark:text-cyan-200 dark:text-green-200 dark:text-violet-200 text-orange-800 dark:text-orange-200 md:block"})]})}function c(e){let{children:t,id:s,value:a,onChange:r}=e;return(0,l.jsxs)("div",{className:"flex items-center gap-1 justify-start w-max",children:[(0,l.jsx)("input",{type:"checkbox",id:s,className:"peer",checked:a,onChange:r}),(0,l.jsx)("label",{htmlFor:s,className:" text-slate-800 dark:text-slate-200  peer-checked:text-indigo-700 dark:peer-checked:text-indigo-400",children:t})]})}var u=s(73731);function h(e){let{initialFrom:t="",initialTo:s="",onChange:r}=e,[n,i]=(0,a.useState)(t),[o,d]=(0,a.useState)(s),c=e=>{let t=o;o&&e>o&&d(t=e),i(e),null==r||r({from:e,to:t})},h=e=>{let t=n;n&&e<n&&i(t=e),d(e),null==r||r({from:t,to:e})};return(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(u.A,{type:"date",size:"small",value:n,onChange:e=>c(e.target.value),fullWidth:!0}),(0,l.jsx)("span",{children:"-"}),(0,l.jsx)(u.A,{type:"date",size:"small",value:o,onChange:e=>h(e.target.value),fullWidth:!0})]})}function m(e){return(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"mb-1",children:e.label}),(0,l.jsx)(h,{initialFrom:e.initialFrom,initialTo:e.initialTo,onChange:e.onChange})]})}var x=s(33989),p=s(76380),f=s(63954),g=s(5180),v=s(40931);function j(){let{filters:e,setFilters:t,resetFilters:s}=(0,g.Ay)(),{users:a}=(0,v.Ay)();return(0,l.jsxs)("aside",{className:"scrollbar-whatsapp w-full overflow-y-auto rounded-md bg-slate-200 px-4 text-sm text-slate-800 dark:bg-slate-800 dark:text-slate-200 md:w-96",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between py-2",children:[(0,l.jsx)("h1",{className:"text-lg font-semibold",children:"Filtros"}),(0,l.jsx)("button",{className:"text-sm text-blue-500 hover:underline",onClick:s,children:"Limpar Filtros"})]}),(0,l.jsxs)("section",{className:"flex flex-col gap-2 border-b border-slate-600 py-2 dark:border-slate-400",children:[(0,l.jsx)("h2",{className:"text-md font-semibold",children:"Pesquisar"}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)(u.A,{placeholder:"Digite o texto da pesquisa",fullWidth:!0,size:"small",slotProps:{input:{startAdornment:(0,l.jsx)(x.A,{position:"start",children:(0,l.jsx)(f.A,{className:"text-slate-500"})})}}})})]}),(0,l.jsxs)("section",{className:"border-b border-slate-600 py-2 dark:border-slate-400",children:[(0,l.jsx)("h2",{className:"text-md mb-2 font-semibold",children:"Categorias"}),(0,l.jsxs)("ul",{className:"flex flex-col gap-2 pl-2",children:[(0,l.jsx)(c,{id:"monit-filter:external-chats",value:e.categories.showCustomerChats,onChange:s=>t({...e,categories:{...e.categories,showCustomerChats:s.target.checked}}),children:"Exibir: Conversas com clientes"}),(0,l.jsx)(c,{id:"monit-filter:internal-chats",value:e.categories.showInternalChats,onChange:s=>t({...e,categories:{...e.categories,showInternalChats:s.target.checked}}),children:"Exibir: Conversas internas"}),(0,l.jsx)(c,{id:"monit-filter:internal-groups",value:e.categories.showInternalGroups,onChange:s=>t({...e,categories:{...e.categories,showInternalGroups:s.target.checked}}),children:"Exibir: Grupos internos"}),(0,l.jsx)(c,{id:"monit-filter:show-past-scheduled",value:e.categories.showSchedules,onChange:s=>t({...e,categories:{...e.categories,showSchedules:s.target.checked}}),children:"Exibir: Agendamentos"})]})]}),(0,l.jsxs)("section",{className:"border-b border-slate-600 py-2 dark:border-slate-400",children:[(0,l.jsx)("h2",{className:"text-md mb-4 font-semibold",children:"Atendente / Participante"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 pl-2",children:[(0,l.jsxs)(u.A,{select:!0,size:"small",label:"Usu\xe1rio",fullWidth:!0,defaultValue:"all",value:e.user,onChange:s=>{console.log("Selected user:",s.target.value),t({...e,user:"all"===s.target.value?"all":Number(s.target.value)})},children:[(0,l.jsx)(p.A,{value:"all",children:"Todos"}),a.map(e=>(0,l.jsx)(p.A,{value:e.CODIGO,children:e.NOME},e.CODIGO))]}),(0,l.jsx)(c,{id:"monit-filter:show-bots",value:e.showBots,onChange:s=>{t({...e,showBots:s.target.checked})},children:"Exibir bots"})]})]}),(0,l.jsxs)("section",{className:"border-b border-slate-600 py-2 dark:border-slate-400",children:[(0,l.jsx)("h2",{className:"text-md font-semibold",children:"Per\xedodo da conversa"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 py-2 pl-2",children:[(0,l.jsx)(c,{id:"monit-filter:show-ongoing",value:e.showOngoing,onChange:s=>{t({...e,showOngoing:s.target.checked})},children:"Exibir: Em andamento"}),(0,l.jsx)(c,{id:"monit-filter:show-finished",value:e.showFinished,onChange:s=>{t({...e,showFinished:s.target.checked})},children:"Exibir: Finalizados"}),(0,l.jsx)(m,{label:"Data de In\xedcio"}),(0,l.jsx)(m,{label:"Data de Finaliza\xe7\xe3o"})]})]}),(0,l.jsxs)("section",{className:"py-2",children:[(0,l.jsx)("h2",{className:"text-md font-semibold",children:"Agendamentos"}),(0,l.jsxs)("div",{className:"flex flex-col gap-2 py-2 pl-2",children:[(0,l.jsx)(c,{id:"monit-filter:show-only-scheduled",value:e.showOnlyScheduled,onChange:s=>{t({...e,showOnlyScheduled:s.target.checked})},children:"Exibir: Apenas agendados"}),(0,l.jsx)(m,{label:"Agendado no dia"}),(0,l.jsx)(m,{label:"Agendado para o dia"}),(0,l.jsx)("div",{className:"my-2",children:(0,l.jsxs)(u.A,{select:!0,size:"small",label:"Agendado por",fullWidth:!0,defaultValue:"all",children:[(0,l.jsx)(p.A,{value:"all",children:"Qualquer"}),(0,l.jsx)(p.A,{value:"user1",children:"Usu\xe1rio 1"}),(0,l.jsx)(p.A,{value:"user2",children:"Usu\xe1rio 2"}),(0,l.jsx)(p.A,{value:"user3",children:"Usu\xe1rio 3"})]})}),(0,l.jsxs)(u.A,{select:!0,size:"small",label:"Agendado para",fullWidth:!0,defaultValue:"all",children:[(0,l.jsx)(p.A,{value:"all",children:"Qualquer"}),(0,l.jsx)(p.A,{value:"user1",children:"Usu\xe1rio 1"}),(0,l.jsx)(p.A,{value:"user2",children:"Usu\xe1rio 2"}),(0,l.jsx)(p.A,{value:"user3",children:"Usu\xe1rio 3"})]})]})]})]})}var A=s(88702),b=s(3099),w=s(25232),y=s(42732),N=s(92697),C=s(72724),D=s(39447),T=s(97609),I=s(10576),k=s(70266),O=s(97308),S=s(67840),E=s(44432);function F(e,t,s){if(!("chatType"in e)||"wpp"===e.chatType){let s=t.find(t=>t.id===e.sectorId);return s?s.name:null}if("internal"===e.chatType){let l=s.find(t=>t.CODIGO===e.creatorId),a=l&&t.find(e=>e.id===l.SETOR);return a?a.name:null}}function G(e,t){if(!("chatType"in e))return"";if("wpp"===e.chatType)return e.avatarUrl||"";if("internal"===e.chatType&&e.isGroup&&e.groupImageFileId)return w.A.getFileDownloadUrl(e.groupImageFileId);if("internal"===e.chatType&&!e.isGroup){let s=t.find(t=>t.CODIGO!==e.creatorId);return(null==s?void 0:s.AVATAR_ID)?w.A.getFileDownloadUrl(s.AVATAR_ID):""}return""}function M(e){var t,s;return"chatType"in e?"wpp"===e.chatType?(null===(s=e.contact)||void 0===s?void 0:s.name)||"Contato exclu\xeddo":"internal"===e.chatType&&e.isGroup?e.groupName||"Grupo Interno":"internal"!==e.chatType||e.isGroup?"Chat sem t\xedtulo":e.users.map(e=>e.NOME).join(" e ")||"Usu\xe1rio Desconhecido":(null===(t=e.contact)||void 0===t?void 0:t.name)||"Contato exclu\xeddo"}function z(e){if(!("chatType"in e)||"wpp"===e.chatType){var t;return(null===(t=e.customer)||void 0===t?void 0:t.RAZAO)||"Sem cliente associado"}return null}function W(e){if(!("chatType"in e)||"wpp"===e.chatType){var t;return(null===(t=e.customer)||void 0===t?void 0:t.CPF_CNPJ)||e.customer?"Documento n\xe3o informado":null}return null}function U(e){if(!("chatType"in e)||"wpp"===e.chatType){var t;return(null===(t=e.contact)||void 0===t?void 0:t.phone)?y.Formatter.phone(e.contact.phone):"Whatsapp n\xe3o encontrado"}return null}function _(e,t){if(!("chatType"in e))return[];if("internal"===e.chatType&&e.isGroup)return e.users.map(e=>e.NOME);if("internal"===e.chatType&&!e.isGroup){let t=e.users.find(t=>t.CODIGO!==e.creatorId);return t?[t.NOME]:[]}return[]}function P(e){return"chatType"in e?"wpp"===e.chatType&&e.schedule?(0,b.A)(e.schedule.scheduledAt):null:(0,b.A)(e.scheduledAt)}function B(e){return"chatType"in e?"wpp"===e.chatType&&e.schedule?(0,b.A)(e.schedule.scheduleDate):null:(0,b.A)(e.scheduleDate)}function q(e){return"chatType"in e?"internal"===e.chatType&&e.isGroup?e.groupName||"Grupo sem nome":null:""}function R(e){return"chatType"in e?"internal"===e.chatType&&e.isGroup?e.groupDescription||"Sem descri\xe7\xe3o":null:""}function V(){let{chats:e}=(0,g.Ay)(),{sectors:t}=(0,A.jb)(),{users:s}=(0,v.Ay)(),{getChatsMonitor:r,setCurrentChat:n,openChat:i}=(0,A.jb)(),{openInternalChat:o,setCurrentChat:c}=(0,a.useContext)(v.xI),{openModal:u,closeModal:h}=(0,a.useContext)(N.BR);function m(e){return"chatType"in e?"wpp"===e.chatType?()=>{n(e),u((0,l.jsx)(C.A,{}))}:void 0:null}function x(e){return"chatType"in e?"wpp"===e.chatType?()=>{var t,s,a,r,o,d;n(e),i(e),u((0,l.jsxs)("div",{className:"relative flex h-[80vh] w-[500px] flex-col rounded-md bg-slate-900 shadow-xl dark:bg-slate-800",children:[(0,l.jsx)("button",{onClick:()=>null==h?void 0:h(),className:"absolute right-2 top-1 z-10 text-gray-700 hover:text-red-500 dark:text-gray-300 dark:hover:text-red-300",children:"✕"}),(0,l.jsxs)(D.A,{children:[(0,l.jsx)(T.A,{avatarUrl:e.avatarUrl,name:(null===(t=e.contact)||void 0===t?void 0:t.name)||"Contato exclu\xeddo",customerName:(null===(s=e.customer)||void 0===s?void 0:s.RAZAO)||"N/D",chatType:e.chatType,codErp:(null===(a=e.customer)||void 0===a?void 0:a.COD_ERP)||null,cpfCnpj:(null===(r=e.customer)||void 0===r?void 0:r.CPF_CNPJ)||null,customerId:(null===(o=e.customer)||void 0===o?void 0:o.CODIGO)||null,startDate:e.startedAt?new Date(e.startedAt).toDateString():null,phone:(null===(d=e.contact)||void 0===d?void 0:d.phone)||"N/D"}),(0,l.jsx)("div",{className:"scrollbar-whatsapp flex-1 bg-white text-black drop-shadow-md dark:bg-slate-900 dark:text-white",children:(0,l.jsx)(I.A,{})}),(0,l.jsx)("div",{className:"border-t border-gray-200 bg-white p-2 text-black dark:border-gray-700 dark:bg-slate-900",children:(0,l.jsx)(k.A,{})})]})]}))}:"internal"===e.chatType?()=>{console.log(e),c(e),o(e,!1),u((0,l.jsxs)("div",{className:"relative flex h-[80vh] w-[calc(100vw-4rem)] max-w-[1200px] flex-col rounded-md bg-slate-900 shadow-xl dark:bg-slate-800",children:[(0,l.jsx)("button",{onClick:()=>null==h?void 0:h(),className:"absolute right-2 top-1 z-10 text-gray-700 hover:text-red-500 dark:text-gray-300 dark:hover:text-red-300",children:"✕"}),(0,l.jsxs)(D.A,{children:[(0,l.jsx)(T.A,{avatarUrl:"",name:e.groupName||e.users[0].NOME,customerName:e.groupDescription||e.users[0].NOME_EXIBICAO||"",phone:e.users[0].SETOR_NOME||"",chatType:e.chatType,codErp:null,cpfCnpj:null,customerId:null,startDate:e.startedAt?new Date(e.startedAt).toDateString():null}),(0,l.jsx)("div",{className:"scrollbar-whatsapp flex-1 bg-white text-black drop-shadow-md dark:bg-slate-900 dark:text-white",children:(0,l.jsx)(O.A,{})}),(0,l.jsx)("div",{className:"border-t border-gray-200 bg-white p-2 text-black dark:border-gray-700 dark:bg-slate-900",children:(0,l.jsx)(k.A,{})})]})]}))}:void 0:null}function p(e){return"chatType"in e&&"wpp"===e.chatType?()=>{n(e),u((0,l.jsx)(S.A,{})),r()}:null}let[f,w]=(0,a.useState)(1),y=Math.ceil(e.length/20),V=e.slice((f-1)*20,20*f);return(0,l.jsx)("div",{className:"mx-auto grid h-[98%] w-full max-w-[1366px] grid-rows-[auto_1fr] gap-0",children:(0,l.jsxs)("div",{className:"flex w-full gap-2 overflow-hidden p-4",children:[(0,l.jsx)(j,{}),(0,l.jsxs)("main",{className:"scrollbar-whatsapp grow  grid grid-rows-[1fr_max-content] gap-4",children:[(0,l.jsx)("ul",{className:"overflow-auto",children:V.map(e=>{if("chatType"in e)return(0,l.jsx)(d,{type:"chatType"in e?"wpp"!==e.chatType||e.isSchedule?"internal"===e.chatType&&e.isGroup?"internal-group":"internal"!==e.chatType||e.isGroup?"scheduled-chat":"internal-chat":"external-chat":"schedule",startDate:(0,b.A)(e.startedAt),endDate:function(e){if(!e.startedAt)return"N\xe3o iniciado";if(!e.finishedAt)return"Em andamento";let t=(0,b.A)(e.finishedAt);return"N/D"===t?null:t}(e),userName:function(e,t){let s=t.find(t=>"wpp"===e.chatType?t.CODIGO===e.userId:t.CODIGO===e.creatorId);return s?s.NOME:"BOT"}(e,s),sectorName:F(e,t,s),imageUrl:G(e,s),chatTitle:M(e),customerName:z(e),contactNumber:U(e),customerDocument:W(e),scheduledAt:P(e),scheduledFor:B(e),isScheduled:"schedule"in e&&!!e.schedule,participants:_(e,s),groupName:q(e),groupDescription:R(e),handleTransfer:m(e),handleView:x(e),handleFinish:p(e)},"".concat(e.chatType,"-").concat(e.id));return(0,l.jsx)(d,{type:"scheduled-chat",startDate:"N\xe3o Iniciado",endDate:".",userName:function(e,t){let s=t.find(t=>t.CODIGO===e.scheduledFor);return s?s.NOME:"Usu\xe1rio Desconhecido"}(e,s),sectorName:F(e,t,s),imageUrl:G(e,s),chatTitle:M(e),customerName:z(e),contactNumber:U(e),customerDocument:W(e),scheduledAt:P(e),scheduledFor:B(e),isScheduled:!("chatType"in e)||"schedule"in e&&!!e.schedule,participants:_(e,s),groupName:q(e),groupDescription:R(e),handleTransfer:m(e),handleView:x(e),handleFinish:p(e)},"schedule-".concat(e.id))})}),0===e.length&&(0,l.jsx)("div",{className:"text-center text-gray-500 mt-8",children:"Nenhum chat encontrado."}),(0,l.jsx)("div",{className:"flex justify-center mt-4",children:(0,l.jsx)(E.A,{count:y,page:f,onChange:(e,t)=>w(t),color:"primary",size:"medium"})})]})]})})}},29157:(e,t,s)=>{Promise.resolve().then(s.bind(s,26317))},97308:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var l=s(95155),a=s(69926),r=s(12115),n=s(88702),i=s(40931),o=s(98892),d=s(86080);function c(){let{currentChatMessages:e,currentChat:t}=(0,r.useContext)(n.ce),{currentInternalChatMessages:s,users:c}=(0,r.useContext)(i.xI),{user:u}=(0,r.useContext)(o.c),h=(0,r.useRef)(null),m=(0,r.useMemo)(()=>{let e=new Map;for(let t of c)e.set(t.CODIGO,t);return e},[c]);return(0,r.useEffect)(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[e,s]),(0,r.useEffect)(()=>{let e=()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)};return document.addEventListener("scroll-to-bottom",e),()=>{document.removeEventListener("scroll-to-bottom",e)}},[]),(0,l.jsxs)("ul",{className:"flex h-full w-full flex-col gap-2 scrollbar-whatsap p-2",ref:h,children:[(null==t?void 0:t.chatType)==="wpp"&&e.length>0&&e.map(e=>(0,l.jsx)(a.Ay,{id:e.id,style:e.from.startsWith("system")?"system":e.from.startsWith("bot")||e.from.startsWith("me:")?"sent":"received",text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize},"message_".concat(e.id))),(null==t?void 0:t.chatType)==="internal"&&m.size>0&&s&&s.length>0&&s.map((e,t,s)=>{var a;let r=Number(e.from.split(":")[1]),n=m.get(r),i=t>0?s[t-1]:null,o=!n||!i||i.from!==e.from;return(0,l.jsx)(d.A,{id:e.id,style:(a=u.CODIGO,"system"===e.from?"system":e.from==="user:".concat(a)?"sent":"received"),groupFirst:o,sentBy:n?n.NOME:"Desconhecido",text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize},"message_".concat(e.id))})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2666,4488,9141,8534,1620,6805,4954,35,3729,4805,9952,5610,8702,931,9595,8441,1684,7358],()=>t(29157)),_N_E=e.O()}]);