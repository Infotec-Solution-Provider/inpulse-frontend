(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9447],{49271:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=new(a(54607)).UsersClient("https://inpulse.infotecrs.inf.br")},88872:(e,t,a)=>{"use strict";a.d(t,{Yc:()=>i,oM:()=>u});var r=a(75955),n=a(59832),l=a(58416),s=a(90404),o=a(2044),c=a(9560);let i=(0,r.Ay)(n.A)(e=>{let{theme:t}=e;return{["&.".concat(l.A.head)]:{color:t.palette.text.primary},borderBottom:"none",["&.".concat(l.A.body)]:{fontSize:14,color:t.palette.text.primary}}}),u=(0,r.Ay)(s.A)(()=>({"&:nth-of-type(even)":{backgroundColor:"rgba(99, 102, 241, 0.05)"},"&:last-child td, &:last-child th":{border:0}}));(0,r.Ay)(o.A)(e=>{let{theme:t}=e;return{["& .".concat(c.A.root)]:{color:t.palette.text.primary,"&.Mui-selected":{backgroundColor:t.palette.primary.main,color:t.palette.text.primary},"&:hover":{backgroundColor:t.palette.primary.main,color:t.palette.text.primary}}}})},93905:(e,t,a)=>{"use strict";a.d(t,{default:()=>P});var r=a(95155),n=a(75955),l=a(59832),s=a(58416),o=a(90404),c=a(2044),i=a(9560);let u=(0,n.Ay)(l.A)(e=>{let{theme:t}=e;return{["&.".concat(s.A.head)]:{color:t.palette.text.primary},borderBottom:"none",["&.".concat(s.A.body)]:{fontSize:14,color:t.palette.text.primary}}}),d=(0,n.Ay)(o.A)(()=>({"&:nth-of-type(even)":{backgroundColor:"rgba(99, 102, 241, 0.05)"},"&:last-child td, &:last-child th":{border:0}}));(0,n.Ay)(c.A)(e=>{let{theme:t}=e;return{["& .".concat(i.A.root)]:{color:t.palette.text.primary,"&.Mui-selected":{backgroundColor:t.palette.primary.main,color:t.palette.text.primary},"&:hover":{backgroundColor:t.palette.primary.main,color:t.palette.text.primary}}}});var p=a(88872);function g(e){let{User:t}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:(0,r.jsx)("p",{className:"w-14",children:t.CODIGO||"N/D"})}),(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:t.ATIVO||"N/D"}),(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:(0,r.jsx)("p",{className:"w-64 truncate",children:t.NOME||"N/D"})}),(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:(0,r.jsx)("p",{className:"w-40 truncate",children:t.EMAIL||"N/D"})}),(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:(0,r.jsx)("p",{className:"w-36 truncate",children:t.SETOR||"N/D"})}),(0,r.jsx)(p.Yc,{className:"px-2 py-3",children:(0,r.jsx)("p",{className:"w-0 truncate"})})]})}var h=a(99776),x=a(14426),m=a(44296),A=a(17976),v=a(12115),j=a(98892),f=a(38543),y=a(49271),b=a(56033),N=a(73731),C=a(76380),w=a(63954);function O(e){let{setLoading:t,setPage:a,setTotalPages:n,setUsers:l,rowsPerPage:s,filters:o,setFilters:c}=e;return(0,r.jsx)(b.A,{children:(0,r.jsxs)(d,{className:"sticky top-0 rounded-md bg-indigo-900",children:[(0,r.jsx)(u,{children:(0,r.jsx)(N.A,{label:"C\xf3digo",variant:"standard",slotProps:{input:{disableUnderline:!0}},value:(null==o?void 0:o.CODIGO)||"",onChange:e=>{let t=e.target.value;isNaN(Number(t))||c(e=>{let a={...e};return t?a.CODIGO=t:delete a.CODIGO,a})}})}),(0,r.jsx)(u,{children:(0,r.jsxs)(N.A,{name:"ATIVO",label:"Ativo",variant:"standard",style:{width:"6rem"},select:!0,slotProps:{input:{disableUnderline:!0}},value:(null==o?void 0:o.ATIVO)||"",onChange:e=>{c(t=>{let a={...t};return e.target.value?a.ATIVO=e.target.value:delete a.ATIVO,a})},children:[(0,r.jsx)(C.A,{value:"",children:"Ambos"},"none"),(0,r.jsx)(C.A,{value:"SIM",children:"Sim"},"SIM"),(0,r.jsx)(C.A,{value:"NAO",children:"N\xe3o"},"NAO")]})}),(0,r.jsx)(u,{children:(0,r.jsx)(N.A,{label:"Nome",variant:"standard",value:(null==o?void 0:o.NOME)||"",slotProps:{input:{disableUnderline:!0}},onChange:e=>c(t=>{let a={...t};return e.target.value?a.NOME=e.target.value:delete a.NOME,a})})}),(0,r.jsx)(u,{children:(0,r.jsx)(N.A,{label:"E-Mail",variant:"standard",slotProps:{input:{disableUnderline:!0}},value:(null==o?void 0:o.EMAIL)||"",onChange:e=>c(t=>{let a={...t};return e.target.value?a.EMAIL=e.target.value:delete a.EMAIL,a})})}),(0,r.jsx)(u,{children:(0,r.jsx)(N.A,{label:"Setor",variant:"standard",value:(null==o?void 0:o.SETOR)||"",slotProps:{input:{disableUnderline:!0}},onChange:e=>c(t=>{let a={...t};return e.target.value?a.SETOR=e.target.value:delete a.SETOR,a})})}),(0,r.jsx)(u,{children:(0,r.jsx)("button",{onClick:function(){t(!0),y.A.getUsers({...o,perPage:s,page:"1"}).then(e=>{l(e.data),a(e.page.current),n(e.page.totalRows),t(!1)})},children:(0,r.jsx)(w.A,{})})})]})})}function P(){let[e,t]=(0,v.useState)([]),{token:a}=(0,v.useContext)(j.c),[n,l]=(0,v.useState)(0),[s,o]=(0,v.useState)(),[i,p]=(0,v.useState)("10"),[b,N]=(0,v.useState)(),[C,w]=(0,v.useState)(!0),[P,S]=(0,v.useState)(!0);(0,v.useEffect)(()=>{a?(y.A.setAuth(a),y.A.getUsers({perPage:i,page:"1"}).then(e=>{console.log(e),t(e.data),o(e.page.totalRows),l(e.page.current),w(!1),S(!1)})):f.oR.error("Erro ao carregar operadores, token inv\xe1lido ou expirado. Recarregue a pagina ou fa\xe7a login novamente")},[]);let E=(0,v.useMemo)(()=>e&&e.length>0&&!C?(0,r.jsx)(h.A,{children:e.map(e=>(0,r.jsx)(g,{User:e},"".concat(e.NOME,"_").concat(e.CODIGO)))}):(0,r.jsx)(h.A,{children:(0,r.jsx)(d,{className:"h-32 w-full",children:(0,r.jsx)(u,{colSpan:8,className:"flex items-center justify-center text-center text-gray-400",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)(x.A,{}),(0,r.jsx)("span",{className:"mt-2",children:"Carregando operadores..."})]})})})}),[e,n]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.A,{className:"mx-auto max-h-[75vh] overflow-auto rounded-md bg-indigo-700 bg-opacity-5 shadow-md",children:(0,r.jsxs)(A.A,{className:"max-h-[100%] overflow-auto",children:[(0,r.jsx)(O,{rowsPerPage:i,setLoading:w,setPage:l,setTotalPages:o,setUsers:t,filters:b,setFilters:N}),E]})}),!P&&(0,r.jsx)("div",{className:"flex h-fit w-full justify-center gap-4 px-4 pt-0",children:(0,r.jsx)(c.A,{component:"div",count:(null!=s?s:1)*+i,page:n-1,rowsPerPage:+i,rowsPerPageOptions:[10,25,50],labelRowsPerPage:"Entradas por p\xe1gina",labelDisplayedRows:e=>{let{from:t,to:a,count:r}=e;return"".concat(t,"-").concat(a," de ").concat(r)},onRowsPerPageChange:e=>{p(e.target.value),l(1),w(!0),y.A.getUsers({...b,perPage:e.target.value}).then(e=>{t(e.data),l(e.page.current),o(e.page.totalRows),w(!1)})},onPageChange:(e,a)=>{var r;return r=a+1>n,void(w(!0),r?y.A.getUsers({...b,page:"".concat(n+1),perPage:i}).then(e=>{t(e.data),l(e.page.current),o(e.page.totalRows),w(!1)}):y.A.getUsers({...b,page:"".concat(n-1),perPage:i}).then(e=>{t(e.data),l(e.page.current),o(e.page.totalRows),w(!1)}))}})})]})}},98892:(e,t,a)=>{"use strict";a.d(t,{c:()=>d,default:()=>g,Z:()=>p});var r=a(95155),n=a(12115);let l=new(a(54607)).AuthClient("https://inpulse.infotecrs.inf.br");var s=a(38543),o=a(23464),c=a(35695),i=a(42732),u=a(49271);let d=(0,n.createContext)({});function p(){let e=(0,n.useContext)(d);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function g(e){let{children:t}=e,a=(0,c.useRouter)(),p=(0,c.usePathname)(),g=(0,n.useRef)(p.split("/")[1]),[h,x]=(0,n.useState)(null),[m,A]=(0,n.useState)(null),v=(0,n.useCallback)(async(e,t)=>{let{login:r,password:n}=t;try{let t=await l.login(e,r,n);localStorage.setItem("@inpulse/".concat(e,"/token"),t.token),g.current=e,x(t.user),A(t.token),o.A.defaults.headers.authorization="Bearer ".concat(t.token),a.replace("/".concat(e))}catch(e){s.oR.error("Falha ao logar!\n"+(0,i.sanitizeErrorMessage)(e))}},[a]),j=(0,n.useCallback)(()=>{A(null),localStorage.removeItem("@inpulse/".concat(g.current,"/token")),a.replace("/".concat(g.current,"/login")),x(null)},[a]);return(0,n.useEffect)(()=>{g.current=p.split("/")[1];let e=localStorage.getItem("@inpulse/".concat(g.current,"/token"));A(e),e&&(u.A.setAuth(e),l.fetchSessionData(e).then(async t=>{g.current=t.instance,o.A.defaults.headers.authorization="Bearer ".concat(e),u.A.setAuth("Bearer ".concat(e)),x(await u.A.getUserById(t.userId)),p.includes("login")&&a.replace("/".concat(g.current))}).catch(e=>{s.oR.error(e.message||"Sess\xe3o expirada, fa\xe7a o login novamente!"),localStorage.removeItem("@inpulse/".concat(g.current,"/token")),x(null),p.includes("login")||a.replace("/".concat(g.current,"/login"))})),e||p.includes("login")||a.replace("/".concat(g.current,"/login"))},[p,a]),(0,r.jsx)(d.Provider,{value:{user:h,token:m,isAuthenticated:!1,signIn:v,signOut:j,instance:g.current},children:t})}},99302:(e,t,a)=>{Promise.resolve().then(a.bind(a,93905))}},e=>{var t=t=>e(e.s=t);e.O(0,[4488,9141,5332,4290,652,8441,1684,7358],()=>t(99302)),_N_E=e.O()}]);