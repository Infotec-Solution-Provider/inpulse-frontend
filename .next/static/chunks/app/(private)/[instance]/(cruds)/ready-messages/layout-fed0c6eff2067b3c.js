(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8914],{48706:(e,t,r)=>{Promise.resolve().then(r.bind(r,72556))},49271:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=new(r(54607)).UsersClient("https://inpulse.infotecrs.inf.br")},72556:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var a=r(95155),n=r(78286);function o(e){let{children:t}=e;return(0,a.jsx)(n.A,{children:t})}},78286:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,m:()=>u});var a=r(95155),n=r(54607),o=r(12115),c=r(98892),s=r(38543);let l=(0,o.createContext)({}),u=()=>(0,o.useContext)(l);function i(e){let{children:t}=e,{token:r}=(0,o.useContext)(c.c),[u,i]=(0,o.useState)([]),d=(0,o.useRef)(new n.ReadyMessageClient("https://inpulse.infotecrs.inf.br")),p=[{name:"@sauda\xe7\xe3o_tempo",replaceFor:"currentSaudation"},{name:"@cliente_razao",replaceFor:"customerRazao"},{name:"@cliente_cnpj",replaceFor:"customerCnpj"},{name:"@atendente_nome",replaceFor:"operatorName"},{name:"@atendente_nome_exibicao",replaceFor:"operatorNameExibition"},{name:"@contato_primeiro_nome",replaceFor:"customerFirstName"},{name:"@contato_nome_completo",replaceFor:"customerFullName"}],m=(0,o.useCallback)(async(e,t,a)=>{if(r)try{if(!a)return;let r=await d.current.updateReadyMessage(e,t,a);i(t=>t.map(t=>t.CODIGO===e?{...t,file:r.ARQUIVO}:t)),s.oR.success("Arquivo do Mensagem pronta atualizada com sucesso!")}catch(e){console.error("Error updating readyMessage image",e),s.oR.error("Erro ao atualizar Arquivo do Mensagem pronta")}},[r]),g=(0,o.useCallback)(async(e,t,a,n)=>{if(r)try{let r=await d.current.createReadyMessage(e,t,a,n);i(e=>[r,...e||[]])}catch(e){console.error("Error creating readyMessage",e),s.oR.error("Erro ao criar Mensagem pronta")}},[r]),h=(0,o.useCallback)(async e=>{if(r)try{await d.current.deleteReadyMessage(e),s.oR.success("Mensagem pronta  deletado com sucesso!"),i(t=>t.filter(t=>t.CODIGO!==e))}catch(e){s.oR.error("Erro ao deletar Mensagem pronta")}},[r]),f=(0,o.useCallback)(async()=>{r&&d.current&&(d.current.setAuth(r),i(await d.current.getReadyMessages()))},[r]);return(0,o.useEffect)(()=>{r&&d.current&&(d.current.setAuth(r),d.current.getReadyMessages().then(e=>{i(e)}))},[r,d.current]),(0,a.jsx)(l.Provider,{value:{readyMessages:u,updateReadyMessage:m,createReadyMessage:g,deleteReadyMessage:h,variables:p,replaceVariables:function(e){let{message:t,values:r}=e;return p.forEach(e=>{t=t.replaceAll(e.name,r[e.replaceFor])}),t},fetchReadyMessages:f},children:t})}},98892:(e,t,r)=>{"use strict";r.d(t,{c:()=>d,default:()=>m,Z:()=>p});var a=r(95155),n=r(12115);let o=new(r(54607)).AuthClient("https://inpulse.infotecrs.inf.br");var c=r(38543),s=r(23464),l=r(35695),u=r(42732),i=r(49271);let d=(0,n.createContext)({});function p(){let e=(0,n.useContext)(d);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function m(e){let{children:t}=e,r=(0,l.useRouter)(),p=(0,l.usePathname)(),m=(0,n.useRef)(p.split("/")[1]),[g,h]=(0,n.useState)(null),[f,A]=(0,n.useState)(null),C=(0,n.useCallback)(async(e,t)=>{let{login:a,password:n}=t;try{let t=await o.login(e,a,n);localStorage.setItem("@inpulse/".concat(e,"/token"),t.token),m.current=e,h(t.user),A(t.token),s.A.defaults.headers.authorization="Bearer ".concat(t.token),r.replace("/".concat(e))}catch(e){c.oR.error("Falha ao logar!\n"+(0,u.sanitizeErrorMessage)(e))}},[r]),y=(0,n.useCallback)(()=>{A(null),localStorage.removeItem("@inpulse/".concat(m.current,"/token")),r.replace("/".concat(m.current,"/login")),h(null)},[r]);return(0,n.useEffect)(()=>{m.current=p.split("/")[1];let e=localStorage.getItem("@inpulse/".concat(m.current,"/token"));A(e),e&&(i.A.setAuth(e),o.fetchSessionData(e).then(async t=>{m.current=t.instance,s.A.defaults.headers.authorization="Bearer ".concat(e),i.A.setAuth("Bearer ".concat(e)),h(await i.A.getUserById(t.userId)),p.includes("login")&&r.replace("/".concat(m.current))}).catch(e=>{c.oR.error(e.message||"Sess\xe3o expirada, fa\xe7a o login novamente!"),localStorage.removeItem("@inpulse/".concat(m.current,"/token")),h(null),p.includes("login")||r.replace("/".concat(m.current,"/login"))})),e||p.includes("login")||r.replace("/".concat(m.current,"/login"))},[p,r]),(0,a.jsx)(d.Provider,{value:{user:g,token:f,isAuthenticated:!1,signIn:C,signOut:y,instance:m.current},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4488,8441,1684,7358],()=>t(48706)),_N_E=e.O()}]);