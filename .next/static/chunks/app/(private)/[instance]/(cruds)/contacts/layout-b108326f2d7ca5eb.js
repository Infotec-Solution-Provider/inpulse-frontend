(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8673],{56204:(e,a,t)=>{"use strict";t.d(a,{Jj:()=>y,Ay:()=>D,GC:()=>w});var r=t(95155),n=t(12115),c=t(54607),l=t(98892),o=t(42732),i=t(38543),s=t(88702),d=t(16324),u=t(27943),x=t(56278),h=t(54492),p=t(3127),C=t(99927),g=t(73731),f=t(22883),j=t(71977),A=t(68534),m=t(69242);function b(e){let{contact:a}=e,{closeModal:t,modal:c,createContact:l,updateContact:o}=w(),s=!!a,[b,k]=(0,n.useState)((null==a?void 0:a.name)||""),[v,y]=(0,n.useState)("+55"),[D,R]=(0,n.useState)(""),E=(0,d.A)(),S=(0,u.A)(E.breakpoints.down("sm")),W=e=>{let a=e.replace(/\D/g,"");return a.length<=2?"(".concat(a):a.length<=6?"(".concat(a.slice(0,2),") ").concat(a.slice(2)):a.length<=10?"(".concat(a.slice(0,2),") ").concat(a.slice(2,6),"-").concat(a.slice(6)):"(".concat(a.slice(0,2),") ").concat(a.slice(2,7),"-").concat(a.slice(7,11))};return(0,r.jsxs)(x.A,{open:!!c,onClose:(e,a)=>{"backdropClick"!==a&&t()},fullScreen:S,maxWidth:!1,sx:{"& .MuiDialog-paper":{width:"360px",maxWidth:"90vw",borderRadius:3,padding:2}},children:[(0,r.jsxs)(h.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 16px"},children:[s?"Editar Contato":"Cadastrar Contato",(0,r.jsx)(p.A,{onClick:t,children:(0,r.jsx)(m.A,{})})]}),(0,r.jsxs)(C.A,{sx:{display:"flex",flexDirection:"column",gap:2,paddingTop:5},children:[(0,r.jsx)(g.A,{label:"Nome",fullWidth:!0,value:b,onChange:e=>k(e.target.value),variant:"filled"}),!s&&(0,r.jsxs)(f.A,{direction:"row",spacing:1,children:[(0,r.jsx)(g.A,{label:"DDI",value:v,onChange:e=>y(e.target.value),sx:{width:"80px"},variant:"filled"}),(0,r.jsx)(g.A,{label:"N\xfamero",placeholder:"(11) 91234-5678",fullWidth:!0,value:D,variant:"filled",onChange:e=>R(W(e.target.value))})]})]}),(0,r.jsxs)(j.A,{sx:{justifyContent:"flex-end"},children:[(0,r.jsx)(A.A,{color:"error",onClick:t,children:"Cancelar"}),(0,r.jsx)(A.A,{variant:"contained",onClick:()=>{if(!b.trim()){i.oR.error("O nome \xe9 obrigat\xf3rio!");return}if(s)o(a.id,b);else{if(!D.trim()||!v.trim()){i.oR.error("Telefone completo (DDI + N\xfamero) \xe9 obrigat\xf3rio!");return}l(b,"".concat(v).concat(D.replace(/\D/g,"")))}t()},children:s?"Salvar":"Cadastrar"})]})]})}var k=t(700);function v(e){let{contact:a}=e,{deleteContact:t,closeModal:n}=w(),c=(0,d.A)(),l=(0,u.A)(c.breakpoints.down("sm"));return(0,r.jsxs)(x.A,{open:!0,onClose:(e,a)=>{"backdropClick"!==a&&n()},fullScreen:l,maxWidth:!1,sx:{"& .MuiDialog-paper":{width:"360px",maxWidth:"90vw",borderRadius:3,padding:2}},children:[(0,r.jsxs)(h.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 16px"},children:["Deletar Contato",(0,r.jsx)(p.A,{onClick:n,children:(0,r.jsx)(m.A,{})})]}),(0,r.jsx)(C.A,{sx:{display:"flex",flexDirection:"column",gap:2,paddingTop:5},children:(0,r.jsxs)(k.A,{variant:"body1",children:["Tem certeza que deseja excluir o contato"," ",(0,r.jsxs)("strong",{style:{color:c.palette.error.main},children:['"',a.name,'"']}),"?"]})}),(0,r.jsxs)(j.A,{sx:{justifyContent:"flex-end"},children:[(0,r.jsx)(A.A,{color:"error",onClick:n,children:"Cancelar"}),(0,r.jsx)(A.A,{variant:"contained",color:"error",onClick:()=>{t(a.id),n()},children:"Deletar"})]})]})}let y=(0,n.createContext)({}),w=()=>(0,n.useContext)(y);function D(e){let{children:a}=e,t=(0,n.useRef)(new c.WhatsappClient(s.M1)),{token:d}=(0,l.Z)(),[u,x]=(0,n.useState)([]),[h,p]=(0,n.useState)(!1),[C,g]=(0,n.useState)(null),f=(0,n.useCallback)(async(e,a)=>{try{if(d){let r=await t.current.updateContact(e,a);x(a=>a.map(a=>a.id===e?r:a)),k(),i.oR.success("Cliente atualizado com sucesso!")}}catch(e){o.Logger.error("Error updating contact",e),i.oR.error("Falha ao atualizar cliente!")}},[d]),j=(0,n.useCallback)(async e=>{try{d&&(await t.current.deleteContact(e),x(a=>a.filter(a=>a.id!==e)),i.oR.success("Contato deletado com sucesso!"))}catch(e){o.Logger.error("Error deleting contact",e),i.oR.error("Falha ao deletar cliente!")}},[d]),A=(0,n.useCallback)(async(e,a)=>{try{if(d){let r=await t.current.createContact(e,a.replace(/\D/g,""));x(e=>[...e,r]),i.oR.success("Contato criado com sucesso!"),k()}}catch(e){o.Logger.error("Error criar contact",e),i.oR.error("Falha ao atualizar cliente!")}},[d]),m=(0,n.useCallback)(e=>{g((0,r.jsx)(b,{contact:e}))},[A,f]),k=(0,n.useCallback)(()=>{g(null)},[]),w=(0,n.useCallback)(e=>{g((0,r.jsx)(v,{contact:e}))},[j]),D=(0,n.useCallback)(async()=>{try{p(!0);let e=await t.current.getContacts();x(e)}catch(e){o.Logger.error("Error loading contacts",e),i.oR.error("Falha ao carregar clientes!")}finally{p(!1)}},[]);return(0,n.useEffect)(()=>{d&&t.current&&(t.current.setAuth(d),D())},[d,t.current]),(0,r.jsxs)(y.Provider,{value:{contacts:u,updateContact:f,loadContacts:D,createContact:A,deleteContact:j,isLoading:h,openContactModal:m,closeModal:k,modal:C,handleDeleteContact:w},children:[a,C]})}},76141:(e,a,t)=>{Promise.resolve().then(t.bind(t,88159))},88159:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var r=t(95155),n=t(56204);function c(e){let{children:a}=e;return(0,r.jsx)(n.Ay,{children:a})}}},e=>{var a=a=>e(e.s=a);e.O(0,[4488,9141,8534,1620,6805,35,8702,8441,1684,7358],()=>a(76141)),_N_E=e.O()}]);