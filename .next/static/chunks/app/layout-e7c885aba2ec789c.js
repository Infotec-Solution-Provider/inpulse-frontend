(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{6941:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,18466,23)),Promise.resolve().then(n.bind(n,38543)),Promise.resolve().then(n.bind(n,98892)),Promise.resolve().then(n.t.bind(n,30347,23))},18466:e=>{e.exports={style:{fontFamily:"'Fira Sans', 'Fira Sans Fallback'",fontStyle:"normal"},className:"__className_c590c5",variable:"__variable_c590c5"}},30347:()=>{},49271:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=new(n(54607)).UsersClient("https://inpulse.infotecrs.inf.br")},98892:(e,t,n)=>{"use strict";n.d(t,{c:()=>h,default:()=>p,Z:()=>d});var r=n(95155),a=n(12115);let l=new(n(54607)).AuthClient("https://inpulse.infotecrs.inf.br");var c=n(38543),s=n(23464),o=n(35695),i=n(42732),u=n(49271);let h=(0,a.createContext)({});function d(){let e=(0,a.useContext)(h);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function p(e){let{children:t}=e,n=(0,o.useRouter)(),d=(0,o.usePathname)(),p=(0,a.useRef)(d.split("/")[1]),[f,m]=(0,a.useState)(null),[g,v]=(0,a.useState)(null),b=(0,a.useCallback)(async(e,t)=>{let{login:r,password:a}=t;try{let t=await l.login(e,r,a);localStorage.setItem("@inpulse/".concat(e,"/token"),t.token),p.current=e,m(t.user),v(t.token),s.A.defaults.headers.authorization="Bearer ".concat(t.token),n.replace("/".concat(e))}catch(e){c.oR.error("Falha ao logar!\n"+(0,i.sanitizeErrorMessage)(e))}},[n]),k=(0,a.useCallback)(()=>{v(null),localStorage.removeItem("@inpulse/".concat(p.current,"/token")),n.replace("/".concat(p.current,"/login")),m(null)},[n]);return(0,a.useEffect)(()=>{p.current=d.split("/")[1];let e=localStorage.getItem("@inpulse/".concat(p.current,"/token"));v(e),e&&(u.A.setAuth(e),l.fetchSessionData(e).then(async t=>{p.current=t.instance,s.A.defaults.headers.authorization="Bearer ".concat(e),u.A.setAuth("Bearer ".concat(e)),m(await u.A.getUserById(t.userId)),d.includes("login")&&n.replace("/".concat(p.current))}).catch(e=>{c.oR.error(e.message||"Sess\xe3o expirada, fa\xe7a o login novamente!"),localStorage.removeItem("@inpulse/".concat(p.current,"/token")),m(null),d.includes("login")||n.replace("/".concat(p.current,"/login"))})),e||d.includes("login")||n.replace("/".concat(p.current,"/login"))},[d,n]),(0,r.jsx)(h.Provider,{value:{user:f,token:g,isAuthenticated:!1,signIn:b,signOut:k,instance:p.current},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6730,4488,8441,1684,7358],()=>t(6941)),_N_E=e.O()}]);