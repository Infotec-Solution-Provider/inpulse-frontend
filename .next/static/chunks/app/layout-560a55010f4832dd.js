(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{6941:(e,t,n)=>{Promise.resolve().then(n.t.bind(n,18466,23)),Promise.resolve().then(n.bind(n,38543)),Promise.resolve().then(n.bind(n,98892)),Promise.resolve().then(n.t.bind(n,30347,23))},18466:e=>{e.exports={style:{fontFamily:"'Fira Sans', 'Fira Sans Fallback'",fontStyle:"normal"},className:"__className_c590c5",variable:"__variable_c590c5"}},30347:()=>{},49271:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});let a=new(n(54607)).UsersClient("http://localhost:8001")},98892:(e,t,n)=>{"use strict";n.d(t,{c:()=>h,default:()=>m,Z:()=>d});var a=n(95155),r=n(12115);let l=new(n(54607)).AuthClient("http://localhost:8001");var c=n(38543),o=n(23464),s=n(35695),u=n(42732),i=n(49271);let h=(0,r.createContext)({});function d(){let e=(0,r.useContext)(h);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function m(e){let{children:t}=e,n=(0,s.useRouter)(),d=(0,s.usePathname)(),m=(0,r.useRef)(d.split("/")[1]),[p,g]=(0,r.useState)(null),[f,v]=(0,r.useState)(null),k=(0,r.useCallback)(async(e,t)=>{let{login:a,password:r}=t;try{let t=await l.login(e,a,r);localStorage.setItem("@inpulse/".concat(e,"/token"),t.token),m.current=e,g(t.user),v(t.token),o.A.defaults.headers.authorization="Bearer ".concat(t.token),n.replace("/".concat(e))}catch(e){c.oR.error("Falha ao logar!\n"+(0,u.sanitizeErrorMessage)(e))}},[n]),b=(0,r.useCallback)(()=>{v(null),localStorage.removeItem("@inpulse/".concat(m.current,"/token")),n.replace("/".concat(m.current,"/login")),g(null)},[n]);return(0,r.useEffect)(()=>{m.current=d.split("/")[1];let e=localStorage.getItem("@inpulse/".concat(m.current,"/token"));v(e),e&&(i.A.setAuth(e),l.fetchSessionData(e).then(async t=>{m.current=t.instance,o.A.defaults.headers.authorization="Bearer ".concat(e),i.A.setAuth("Bearer ".concat(e)),g(await i.A.getUserById(t.userId)),d.includes("login")&&n.replace("/".concat(m.current))}).catch(e=>{c.oR.error(e.message||"Sess\xe3o expirada, fa\xe7a o login novamente!"),localStorage.removeItem("@inpulse/".concat(m.current,"/token")),g(null),d.includes("login")||n.replace("/".concat(m.current,"/login"))})),e||d.includes("login")||n.replace("/".concat(m.current,"/login"))},[d,n]),(0,a.jsx)(h.Provider,{value:{user:p,token:f,isAuthenticated:!1,signIn:k,signOut:b,instance:m.current},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[6730,4488,8441,1684,7358],()=>t(6941)),_N_E=e.O()}]);