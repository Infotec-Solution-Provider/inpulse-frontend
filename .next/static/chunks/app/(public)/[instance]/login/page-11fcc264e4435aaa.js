(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5435],{11084:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(29839).A)({palette:{mode:"dark"}})},11529:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>d});var r=a(95155),n=a(58035),s=a(66766),l=a(12115),o=a(98892),i=a(33196),c=a(73731),u=a(68534),A=a(11084);function d(e){let{params:t}=e,{signIn:a}=(0,l.useContext)(o.c),d=(0,l.useRef)(null),h=async e=>{e.preventDefault();let{instance:r}=await t,n=Object.fromEntries(new FormData(d.current).entries());await a(r,{login:n.login,password:n.password})};return(0,r.jsx)("div",{className:"flex h-screen w-screen items-center",children:(0,r.jsx)(i.A,{theme:A.A,children:(0,r.jsxs)("form",{className:"mx-auto box-border flex w-80 flex-col gap-4 rounded-md bg-indigo-500/5 px-8 py-8 pt-14",onSubmit:h,ref:d,children:[(0,r.jsx)(s.default,{src:n.A,alt:"Logo",height:64,className:"mb-12"}),(0,r.jsx)(c.A,{title:"Login",name:"login",placeholder:"Digite seu login",required:!0,autoComplete:"username"}),(0,r.jsx)(c.A,{title:"Senha",name:"password",placeholder:"Digite sua senha",type:"password",required:!0,autoComplete:"current-password"}),(0,r.jsx)(u.A,{fullWidth:!0,sx:{paddingTop:1.5,paddingBottom:1.5,marginTop:.5},variant:"contained",type:"submit",children:"Entrar"})]})})})}},49271:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=new(a(54607)).UsersClient("http://localhost:8001")},50546:(e,t,a)=>{Promise.resolve().then(a.bind(a,11529))},58035:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r={src:"/_next/static/media/hlogodark.58e397dd.png",height:590,width:982,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAP1BMVEVMaXHiIiW/PwDsPiPpMiOJJI3sKiXpJSTbLyPxLiXtQyTrNCX1QiTsKiSuIln1LSexH0u5IkPdKSr9LCn/PyjHk6odAAAAE3RSTlMAsgTPUUXjOhXt2LryKsjxc1/iTlJkQAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIDUuMS40Et+mgwAAAC1JREFUeJwFwYcBACAIwLCKIu79/60mAELyBQid+hqaZnQ3B3ScfKMBa5sz5AMV3wEXXx6ffwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5}},98892:(e,t,a)=>{"use strict";a.d(t,{c:()=>A,default:()=>h,Z:()=>d});var r=a(95155),n=a(12115);let s=new(a(54607)).AuthClient("http://localhost:8001");var l=a(38543),o=a(23464),i=a(35695),c=a(42732),u=a(49271);let A=(0,n.createContext)({});function d(){let e=(0,n.useContext)(A);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function h(e){let{children:t}=e,a=(0,i.useRouter)(),d=(0,i.usePathname)(),h=(0,n.useRef)(d.split("/")[1]),[g,p]=(0,n.useState)(null),[m,w]=(0,n.useState)(null),f=(0,n.useCallback)(async(e,t)=>{let{login:r,password:n}=t;try{let t=await s.login(e,r,n);localStorage.setItem("@inpulse/".concat(e,"/token"),t.token),h.current=e,p(t.user),w(t.token),o.A.defaults.headers.authorization="Bearer ".concat(t.token),a.replace("/".concat(e))}catch(e){l.oR.error("Falha ao logar!\n"+(0,c.sanitizeErrorMessage)(e))}},[a]),x=(0,n.useCallback)(()=>{w(null),localStorage.removeItem("@inpulse/".concat(h.current,"/token")),a.replace("/".concat(h.current,"/login")),p(null)},[a]);return(0,n.useEffect)(()=>{h.current=d.split("/")[1];let e=localStorage.getItem("@inpulse/".concat(h.current,"/token"));w(e),e&&(u.A.setAuth(e),s.fetchSessionData(e).then(async t=>{h.current=t.instance,o.A.defaults.headers.authorization="Bearer ".concat(e),u.A.setAuth("Bearer ".concat(e)),p(await u.A.getUserById(t.userId)),d.includes("login")&&a.replace("/".concat(h.current))}).catch(e=>{l.oR.error(e.message||"Sess\xe3o expirada, fa\xe7a o login novamente!"),localStorage.removeItem("@inpulse/".concat(h.current,"/token")),p(null),d.includes("login")||a.replace("/".concat(h.current,"/login"))})),e||d.includes("login")||a.replace("/".concat(h.current,"/login"))},[d,a]),(0,r.jsx)(A.Provider,{value:{user:g,token:m,isAuthenticated:!1,signIn:f,signOut:x,instance:h.current},children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4488,9141,8534,699,8441,1684,7358],()=>t(50546)),_N_E=e.O()}]);