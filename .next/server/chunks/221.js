exports.id=221,exports.ids=[221],exports.modules={3683:(e,t,r)=>{Promise.resolve().then(r.bind(r,93853)),Promise.resolve().then(r.bind(r,30601))},7342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>en});var s=r(60687),a=r(30474),n=r(30594),o=r(83706),l=r(64882),i=r(43210),c=r.n(i),d=r(30601),u=r(17181),h=r(64216),p=r(93010),m=r(82948),x=r(88931),f=r(45525),g=r(68795),C=r(53006),A=r(83685),j=r(60042),b=r(16184),y=r(8734),v=r(47651),k=r(85814),w=r.n(k),R=r(16189);function I({title:e,children:t,href:r,routes:a,disabled:n}){let[o,l]=c().useState(null),i=!!o,d=()=>{l(null)},u=(0,R.usePathname)().split("/")[1];return(0,s.jsx)("li",{"aria-disabled":!!n,className:"relative list-none aria-disabled:hidden",children:(0,s.jsx)(j.A,{title:(0,s.jsx)("h2",{className:"text-base",children:e}),arrow:!0,disableHoverListener:i,children:a?(0,s.jsxs)("div",{children:[(0,s.jsx)(b.A,{onClick:e=>{l(e.currentTarget)},children:t}),(0,s.jsx)(y.A,{anchorEl:o,open:i,onClose:d,children:a.map(e=>(0,s.jsx)(v.A,{onClick:d,children:(0,s.jsx)(w(),{href:`/${u}${e.href}`,children:e.title})},e.title))})]}):(0,s.jsx)(b.A,{component:w(),href:`/${u}${r}`,children:t})})})}var S=r(2597),P=r(66056),E=r(73855),N=r(3895),M=r(10924),D=r(89193),T=r(52171),F=r(73234),L=r(52543),$=r(73806),O=r(98330);let U=(0,r(51052).A)({palette:{mode:"light"}}),z=(0,i.createContext)({theme:"dark",toggleTheme:()=>{}});function W({children:e}){let[t,r]=(0,i.useState)("dark"),a=(0,i.useMemo)(()=>"dark"===t?O.A:U,[t]);return(0,s.jsx)(z.Provider,{value:{theme:t,toggleTheme:()=>{r(e=>"dark"===e?"light":"dark")}},children:(0,s.jsx)($.A,{theme:a,children:e})})}function B(){let{theme:e,toggleTheme:t}=(0,i.useContext)(z);return(0,s.jsx)(A.A,{title:"Alternar tema",onClick:t,sx:{color:"dark"===e?"#FACC15":"#111827"},children:"dark"===e?(0,s.jsx)(F.A,{}):(0,s.jsx)(L.A,{})})}var G=r(55109),_=r(87088),V=r(21360);function J(){let e=(0,V.A)(),{notifications:t,getNotifications:r,markAllAsReadNotification:a}=(0,i.useContext)(T.ce),[n,o]=(0,i.useState)(null),c=()=>{o(null)},d=async()=>{await a(),c()},u=t.filter(e=>!e.read);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.A,{color:"inherit",onClick:e=>{o(e.currentTarget),r()},"aria-label":"notifica\xe7\xf5es",children:(0,s.jsx)(G.A,{badgeContent:u.length,color:"error",max:99,children:(0,s.jsx)(l.A,{sx:{color:e.palette.text.primary}})})}),(0,s.jsxs)(y.A,{anchorEl:n,open:!!n,onClose:c,PaperProps:{style:{maxHeight:400,width:360,padding:0},elevation:4},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,s.jsxs)(x.A,{px:2,py:1,display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"background.paper",borderBottom:1,borderColor:"divider",children:[(0,s.jsx)(_.A,{variant:"h6",component:"div",sx:{fontWeight:"bold"},children:"Notifica\xe7\xf5es"}),(0,s.jsx)(b.A,{size:"small",onClick:d,disabled:!u.length,sx:{textTransform:"none"},children:"Limpar"})]}),0===u.length?(0,s.jsx)(v.A,{disabled:!0,sx:{justifyContent:"center",fontStyle:"italic"},children:"Sem notifica\xe7\xf5es"}):u.map(e=>(0,s.jsx)(v.A,{onClick:c,divider:!0,children:(0,s.jsx)(p.A,{primary:(0,s.jsx)(_.A,{sx:{fontWeight:"medium",fontSize:"1rem"},children:e.title}),secondary:(0,s.jsx)(_.A,{variant:"body2",sx:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"normal"},children:e.description})})},e.id||e.title))]})]})}let K=[{title:"Conversas",href:"/monitor/chats"},{title:"Conversas Internas",href:"/monitor/internal-chats"},{title:"Conversas (Novo)",href:"/monitor"}],X=(e,t)=>{let r=[{title:"Usu\xe1rios",href:"/users"},{title:"Clientes",href:"/customers"},{title:"Contatos",href:"/contacts"},{title:"Mensagens prontas",href:"/ready-messages"}];return("nunes"!==e&&"vollo"!==e||3==t)&&r.push({title:"Grupos Internos",href:"/internal-groups"}),r},H=[{title:"Clientes",href:"/customers"},{title:"Contatos",href:"/contacts"}],Q=({open:e,onClose:t,user:r,instance:l,isUserAdmin:i,signOut:c,reportsRoutes:d})=>{let A=(0,R.usePathname)().split("/")[1],j=e=>e.map(e=>(0,s.jsx)(u.Ay,{disablePadding:!0,children:(0,s.jsx)(w(),{href:`/${A}${e.href}`,className:"w-full",onClick:t,children:(0,s.jsx)(h.A,{children:(0,s.jsx)(p.A,{primary:e.title})})})},e.title));return(0,s.jsx)(m.Ay,{anchor:"right",open:e,onClose:t,PaperProps:{sx:{width:280,bgcolor:"background.paper",color:"text.primary"}},children:(0,s.jsx)(x.A,{role:"presentation",onClick:t,onKeyDown:t,children:(0,s.jsxs)(f.A,{children:[(0,s.jsx)(u.Ay,{children:(0,s.jsx)(w(),{href:`/${l}/`,className:"w-full",children:(0,s.jsx)(a.default,{src:n.A,alt:"Logo",height:36,className:"cursor-pointer"})})}),(0,s.jsx)(g.A,{}),(0,s.jsx)(u.Ay,{children:(0,s.jsx)(w(),{href:`/${l}/`,className:"w-full",children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(C.A,{children:(0,s.jsx)(S.A,{})}),(0,s.jsx)(p.A,{primary:"\xc1rea de Atendimento"})]})})}),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Ay,{children:(0,s.jsx)(p.A,{primary:"Monitoria",sx:{pl:2,pt:1,fontWeight:"bold"}})}),j([{title:"Agendamentos",href:"/monitor/schedules"},{title:"Conversas",href:"/monitor/chats"},{title:"Conversas Internas",href:"/monitor/internal-chats"}])]}),(0,s.jsx)(u.Ay,{children:(0,s.jsx)(p.A,{primary:"Cadastros",sx:{pl:2,pt:1,fontWeight:"bold"}})}),j(i?X(l,r?.SETOR):H),i&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Ay,{children:(0,s.jsx)(p.A,{primary:"Relat\xf3rios",sx:{pl:2,pt:1,fontWeight:"bold"}})}),j(d)]}),(0,s.jsx)(g.A,{sx:{my:2}}),(0,s.jsx)(u.Ay,{children:(0,s.jsxs)(h.A,{onClick:c,children:[(0,s.jsx)(C.A,{children:(0,s.jsx)(o.A,{})}),(0,s.jsx)(p.A,{primary:"Sair"})]})})]})})})};function q(){let{currentChat:e}=(0,i.useContext)(T.ce),{signOut:t,user:r,instance:c}=(0,i.useContext)(d.c),[u,h]=(0,i.useState)(!1),[p,m]=(0,i.useState)(!1);if(p&&e)return null;let x=r?.NIVEL===D.UserRole.ADMIN,f=[{title:"Conversas",href:"/reports/chats"},...r?.NIVEL===D.UserRole.ADMIN?[{title:"Gerador de Relat\xf3rio",href:"/reports/report-generator"}]:[]];return(0,s.jsxs)("header",{className:"sticky top-0 z-20 shadow-md",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)("div",{className:"mx-auto flex w-screen items-center justify-between bg-slate-200 px-4 py-4 dark:bg-slate-800 md:pt-3 pt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[p&&(0,s.jsx)(A.A,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:()=>{h(!u)},className:"mr-2",children:(0,s.jsx)(E.A,{className:"text-gray-900 dark:text-slate-200"})}),(0,s.jsx)(w(),{href:`/${c}/`,children:(0,s.jsx)(a.default,{src:n.A,alt:"Logo",height:36,className:"cursor-pointer"})})]}),(0,s.jsx)("div",{className:"hidden md:flex flex-1 justify-center",children:(0,s.jsx)("nav",{children:(0,s.jsxs)("menu",{className:"flex items-center gap-4 text-sm font-semibold text-gray-900 dark:text-slate-200",children:[(0,s.jsx)(I,{title:"\xc1rea de Atendimento",href:"/",children:(0,s.jsx)(S.A,{className:"text-gray-900 dark:text-slate-200"})}),(0,s.jsx)(I,{title:"Monitoria",routes:K,disabled:!x,children:(0,s.jsx)(P.A,{className:"text-gray-900 dark:text-slate-200"})}),(0,s.jsx)(I,{title:"Cadastros",routes:X(c,r?.SETOR),disabled:!x,children:(0,s.jsx)(M.A,{className:"text-gray-900 dark:text-slate-200"})}),(0,s.jsx)(I,{title:"Cadastros",routes:H,disabled:x,children:(0,s.jsx)(M.A,{className:"text-gray-900 dark:text-slate-200"})}),x&&(0,s.jsx)(I,{title:"Relat\xf3rios",routes:f,children:(0,s.jsx)(N.A,{className:"text-gray-900 dark:text-slate-200"})})]})})}),(0,s.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[(0,s.jsx)(B,{}),(0,s.jsx)(J,{}),(0,s.jsx)("h1",{className:"truncate text-gray-900 dark:text-slate-200 mx-4",children:r?.NOME}),(0,s.jsx)(A.A,{onClick:t,children:(0,s.jsx)(o.A,{className:"text-gray-900 dark:text-slate-200"})})]}),(0,s.jsxs)("div",{className:"flex md:hidden gap-2",children:[(0,s.jsx)(A.A,{children:(0,s.jsx)(l.A,{className:"text-gray-900 dark:text-slate-200"})}),(0,s.jsx)(A.A,{onClick:t,children:(0,s.jsx)(o.A,{className:"text-gray-900 dark:text-slate-200"})})]})]})}),(0,s.jsx)(Q,{open:u,onClose:()=>h(!1),user:r,instance:c,isUserAdmin:x,signOut:t,reportsRoutes:f})]})}var Z=r(12039),Y=r(35118),ee=r(33245),et=r(97015),er=r(55620),es=r(73620),ea=r(51918);function en({children:e}){let[t,r]=(0,i.useState)(null);return(0,s.jsx)("div",{className:"box-border h-auto md:h-screen w-full md:w-screen overflow-hidden",children:(0,s.jsx)(Z.Ay,{modal:t,setModal:r,children:(0,s.jsx)(Y.A,{children:(0,s.jsx)(T.Ay,{children:(0,s.jsx)(ea.Ay,{children:(0,s.jsx)(et.l1,{children:(0,s.jsx)(er.A,{children:(0,s.jsx)(es.Ay,{children:(0,s.jsx)(W,{children:(0,s.jsxs)("div",{className:"grid h-auto md:h-screen w-full md:w-screen auto-rows-max grid-rows-[max-content_minmax(0,1fr)] md:grid-rows-[max-content_minmax(400px,1fr)]",children:[(0,s.jsx)(q,{}),e,(0,s.jsx)(ee.A,{open:!!t,onClose:(e,t)=>{"backdropClick"!==t&&r(null)},className:"flex items-center justify-center",children:(0,s.jsx)("div",{children:t})})]})})})})})})})})})})}},12039:(e,t,r)=>{"use strict";r.d(t,{Ay:()=>l,BR:()=>n,Us:()=>o});var s=r(60687),a=r(43210);let n=(0,a.createContext)({});function o(){let e=(0,a.useContext)(n);if(!e)throw Error("useAppContext must be used within an AppProvider");return e}function l({children:e,modal:t,setModal:r}){return(0,s.jsx)(n.Provider,{value:{modal:t,openModal:e=>{r(e)},closeModal:()=>{r(null)}},children:e})}},20311:(e,t,r)=>{"use strict";function s(e,t){}r.d(t,{X:()=>s})},26398:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\projects\\\\infotec\\\\inpulse\\\\inpulse-frontend\\\\src\\\\app\\\\(private)\\\\[instance]\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\projects\\infotec\\inpulse\\inpulse-frontend\\src\\app\\(private)\\[instance]\\layout.tsx","default")},27659:(e,t,r)=>{Promise.resolve().then(r.bind(r,81819)),Promise.resolve().then(r.bind(r,92177))},27807:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=new(r(89193)).UsersClient("https://inpulse.infotecrs.inf.br")},30594:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s={src:"/_next/static/media/hlogodark.58e397dd.png",height:590,width:982,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAMAAABPT11nAAAAP1BMVEVMaXHiIiW/PwDsPiPpMiOJJI3sKiXpJSTbLyPxLiXtQyTrNCX1QiTsKiSuIln1LSexH0u5IkPdKSr9LCn/PyjHk6odAAAAE3RSTlMAsgTPUUXjOhXt2LryKsjxc1/iTlJkQAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAABh0RVh0U29mdHdhcmUAUGFpbnQuTkVUIDUuMS40Et+mgwAAAC1JREFUeJwFwYcBACAIwLCKIu79/60mAELyBQid+hqaZnQ3B3ScfKMBa5sz5AMV3wEXXx6ffwAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:5}},30601:(e,t,r)=>{"use strict";r.d(t,{c:()=>d,default:()=>h,Z:()=>u});var s=r(60687),a=r(43210);let n=new(r(89193)).AuthClient("https://inpulse.infotecrs.inf.br");var o=r(93853),l=r(51060),i=r(16189),c=r(44366);r(27807);let d=(0,a.createContext)({});function u(){let e=(0,a.useContext)(d);if(!e)throw Error("useAuthContext must be used within an AuthProvider");return e}function h({children:e}){let t=(0,i.useRouter)(),r=(0,i.usePathname)(),u=(0,a.useRef)(r.split("/")[1]),[h,p]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),f=(0,a.useCallback)(async(e,{login:r,password:s})=>{try{let a=await n.login(e,r,s);localStorage.setItem(`@inpulse/${e}/token`,a.token),u.current=e,p(a.user),x(a.token),l.A.defaults.headers.authorization=`Bearer ${a.token}`,t.replace(`/${e}`)}catch(e){o.oR.error("Falha ao logar!\n"+(0,c.sanitizeErrorMessage)(e))}},[t]),g=(0,a.useCallback)(()=>{x(null),localStorage.removeItem(`@inpulse/${u.current}/token`),t.replace(`/${u.current}/login`),p(null)},[t]);return(0,s.jsx)(d.Provider,{value:{user:h,token:m,isAuthenticated:!1,signIn:f,signOut:g,instance:u.current},children:e})}},35118:(e,t,r)=>{"use strict";r.d(t,{d:()=>i,A:()=>c});var s=r(60687),a=r(89193),n=r(43210),o=r(30601),l=r(12039);r(83685),r(46211),r(9134),r(93853);let i=(0,n.createContext)({});function c({children:e}){let{token:t}=(0,n.useContext)(o.c),{openModal:r,closeModal:c}=(0,n.useContext)(l.BR),d=(0,n.useRef)(new a.SocketClient("https://socket.infotecrs.inf.br"));return(0,s.jsx)(i.Provider,{value:{socket:d.current},children:e})}},39727:()=>{},44737:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,16444,23)),Promise.resolve().then(r.t.bind(r,16042,23)),Promise.resolve().then(r.t.bind(r,88170,23)),Promise.resolve().then(r.t.bind(r,49477,23)),Promise.resolve().then(r.t.bind(r,29345,23)),Promise.resolve().then(r.t.bind(r,12089,23)),Promise.resolve().then(r.t.bind(r,46577,23)),Promise.resolve().then(r.t.bind(r,31307,23))},47990:()=>{},51918:(e,t,r)=>{"use strict";r.d(t,{Jj:()=>k,Ay:()=>R,GC:()=>w});var s=r(60687),a=r(43210),n=r(89193),o=r(30601),l=r(44366),i=r(93853),c=r(52171),d=r(21360),u=r(10668),h=r(37204),p=r(24296),m=r(83685),x=r(90764),f=r(60997),g=r(99355),C=r(27674),A=r(16184),j=r(9134);function b({contact:e}){let{closeModal:t,modal:r,createContact:n,updateContact:o}=w(),l=!!e,[c,b]=(0,a.useState)(e?.name||""),[y,v]=(0,a.useState)("+55"),[k,R]=(0,a.useState)(""),I=(0,d.A)(),S=(0,u.A)(I.breakpoints.down("sm")),P=e=>{let t=e.replace(/\D/g,"");return t.length<=2?`(${t}`:t.length<=6?`(${t.slice(0,2)}) ${t.slice(2)}`:t.length<=10?`(${t.slice(0,2)}) ${t.slice(2,6)}-${t.slice(6)}`:`(${t.slice(0,2)}) ${t.slice(2,7)}-${t.slice(7,11)}`};return(0,s.jsxs)(h.A,{open:!!r,onClose:(e,r)=>{"backdropClick"!==r&&t()},fullScreen:S,maxWidth:!1,sx:{"& .MuiDialog-paper":{width:"360px",maxWidth:"90vw",borderRadius:3,padding:2}},children:[(0,s.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 16px"},children:[l?"Editar Contato":"Cadastrar Contato",(0,s.jsx)(m.A,{onClick:t,children:(0,s.jsx)(j.A,{})})]}),(0,s.jsxs)(x.A,{sx:{display:"flex",flexDirection:"column",gap:2,paddingTop:5},children:[(0,s.jsx)(f.A,{label:"Nome",fullWidth:!0,value:c,onChange:e=>b(e.target.value),variant:"filled"}),!l&&(0,s.jsxs)(g.A,{direction:"row",spacing:1,children:[(0,s.jsx)(f.A,{label:"DDI",value:y,onChange:e=>v(e.target.value),sx:{width:"80px"},variant:"filled"}),(0,s.jsx)(f.A,{label:"N\xfamero",placeholder:"(11) 91234-5678",fullWidth:!0,value:k,variant:"filled",onChange:e=>R(P(e.target.value))})]})]}),(0,s.jsxs)(C.A,{sx:{justifyContent:"flex-end"},children:[(0,s.jsx)(A.A,{color:"error",onClick:t,children:"Cancelar"}),(0,s.jsx)(A.A,{variant:"contained",onClick:()=>{if(!c.trim()){i.oR.error("O nome \xe9 obrigat\xf3rio!");return}if(l)o(e.id,c);else{if(!k.trim()||!y.trim()){i.oR.error("Telefone completo (DDI + N\xfamero) \xe9 obrigat\xf3rio!");return}n(c,`${y}${k.replace(/\D/g,"")}`)}t()},children:l?"Salvar":"Cadastrar"})]})]})}var y=r(87088);function v({contact:e}){let{deleteContact:t,closeModal:r}=w(),a=(0,d.A)(),n=(0,u.A)(a.breakpoints.down("sm"));return(0,s.jsxs)(h.A,{open:!0,onClose:(e,t)=>{"backdropClick"!==t&&r()},fullScreen:n,maxWidth:!1,sx:{"& .MuiDialog-paper":{width:"360px",maxWidth:"90vw",borderRadius:3,padding:2}},children:[(0,s.jsxs)(p.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 16px"},children:["Deletar Contato",(0,s.jsx)(m.A,{onClick:r,children:(0,s.jsx)(j.A,{})})]}),(0,s.jsx)(x.A,{sx:{display:"flex",flexDirection:"column",gap:2,paddingTop:5},children:(0,s.jsxs)(y.A,{variant:"body1",children:["Tem certeza que deseja excluir o contato"," ",(0,s.jsxs)("strong",{style:{color:a.palette.error.main},children:['"',e.name,'"']}),"?"]})}),(0,s.jsxs)(C.A,{sx:{justifyContent:"flex-end"},children:[(0,s.jsx)(A.A,{color:"error",onClick:r,children:"Cancelar"}),(0,s.jsx)(A.A,{variant:"contained",color:"error",onClick:()=>{t(e.id),r()},children:"Deletar"})]})]})}let k=(0,a.createContext)({}),w=()=>(0,a.useContext)(k);function R({children:e}){let t=(0,a.useRef)(new n.WhatsappClient(c.M1)),{token:r}=(0,o.Z)(),[d,u]=(0,a.useState)([]),[h,p]=(0,a.useState)(!1),[m,x]=(0,a.useState)(null),f=(0,a.useCallback)(async(e,s)=>{try{if(r){let r=await t.current.updateContact(e,s);u(t=>t.map(t=>t.id===e?r:t)),j(),i.oR.success("Cliente atualizado com sucesso!")}}catch(e){l.Logger.error("Error updating contact",e),i.oR.error("Falha ao atualizar cliente!")}},[r]),g=(0,a.useCallback)(async e=>{try{r&&(await t.current.deleteContact(e),u(t=>t.filter(t=>t.id!==e)),i.oR.success("Contato deletado com sucesso!"))}catch(e){l.Logger.error("Error deleting contact",e),i.oR.error("Falha ao deletar cliente!")}},[r]),C=(0,a.useCallback)(async(e,s)=>{try{if(r){let r=await t.current.createContact(e,s.replace(/\D/g,""));u(e=>[...e,r]),i.oR.success("Contato criado com sucesso!"),j()}}catch(e){l.Logger.error("Error criar contact",e),i.oR.error("Falha ao atualizar cliente!")}},[r]),A=(0,a.useCallback)(e=>{x((0,s.jsx)(b,{contact:e}))},[C,f]),j=(0,a.useCallback)(()=>{x(null)},[]),y=(0,a.useCallback)(e=>{x((0,s.jsx)(v,{contact:e}))},[g]),w=(0,a.useCallback)(async()=>{try{p(!0);let e=await t.current.getContacts();u(e)}catch(e){l.Logger.error("Error loading contacts",e),i.oR.error("Falha ao carregar clientes!")}finally{p(!1)}},[]);return(0,s.jsxs)(k.Provider,{value:{contacts:d,updateContact:f,loadContacts:w,createContact:C,deleteContact:g,isLoading:h,openContactModal:A,closeModal:j,modal:m,handleDeleteContact:y},children:[e,m]})}},52171:(e,t,r)=>{"use strict";r.d(t,{M1:()=>h,ce:()=>p,Ay:()=>m,jb:()=>x});var s=r(60687),a=r(43210),n=r(89193),o=r(30601),l=r(35118);function i(e,t){t.sort((e,t)=>(e.timestamp||0)<(t.timestamp||0)?-1:1);let r={},s={};for(let e of t){let t=e.contactId||0;s[t]||(s[t]=[]),s[t].push(e),(!r[t]||e.timestamp>r[t].timestamp)&&(r[t]=e)}let a=e=>e.from.startsWith("me:")||"system"===e.from,n=[];for(let s of e){let e={...s,chatType:"wpp",isUnread:t.some(e=>e.contactId===s.contactId&&"READ"!==e.status&&!a(e)),lastMessage:s.contactId&&r[s.contactId]||null};n.push(e)}return n.sort((e,t)=>(e.lastMessage?.timestamp||0)<(t.lastMessage?.timestamp||0)?1:-1),{detailedChats:n,chatsMessages:s}}r(81449),r(20311);var c=r(44366);r(30594);function d(e,t){switch(t.type){case"change-showing-type":return{...e,showingType:t.showingType};case"change-search":return{...e,search:t.search};case"reset-filters":return{showingType:"all",search:""};default:return e}}var u=r(93853);let h="https://inpulse.infotecrs.inf.br",p=(0,a.createContext)({});function m({children:e}){let{token:t,user:r,instance:m}=(0,a.useContext)(o.c),{socket:x}=(0,a.useContext)(l.d),[f,g]=(0,a.useState)([]),[C,A]=(0,a.useState)(null),j=(0,a.useRef)(null),[b,y]=(0,a.useState)([]),[v,k]=(0,a.useState)({}),[w,R]=(0,a.useState)([]),I=(0,a.useRef)(new n.WhatsappClient(h)),[S,P]=(0,a.useState)([]),[E,N]=(0,a.useState)([]),[M,D]=(0,a.useState)([]),[T,F]=(0,a.useState)([]),[L,$]=(0,a.useReducer)(d,{search:"",showingType:"all"}),O=(0,a.useCallback)(e=>{A(e),y(v[e.contactId||0]||[]),j.current=e,e.contactId&&(I.current.markContactMessagesAsRead(e.contactId),g(t=>t.map(t=>t.id===e.id?{...t,isUnread:!1}:t)))},[v]),U=(0,a.useCallback)((e,t)=>{g(r=>r.map(r=>r.contact&&r.contactId===e?{...r,contact:{...r.contact,name:t}}:r)),C&&"wpp"===C.chatType&&C.contactId===e&&A(e=>(e.contact.name=t,e))},[C]),z=(0,a.useCallback)((e,r)=>{I.current.setAuth(t||""),I.current.finishChatById(e,r),P(t=>t.filter(t=>t.id!==e))},[I,t]),W=(0,a.useCallback)((e,r)=>{I.current.setAuth(t||""),I.current.transferAttendance(e,r).then(()=>{g(t=>t.filter(t=>t.id!==e)),_()})},[I,t]),B=(0,a.useCallback)((e,t)=>{console.log("Iniciando chat",e,t),I.current.startChatByContactId(e,t)},[I,t]),G=(0,a.useCallback)(async(e,t)=>{I.current.sendMessage(e,t)},[]),_=(0,a.useCallback)(()=>{"string"==typeof t&&t.length>0&&I.current?(I.current.setAuth(t),I.current.getChatsMonitor().then(({chats:e,messages:t})=>{let{chatsMessages:r,detailedChats:s}=i(e,t);console.log("Detailed Chats:",s),P(s),k(r)})):(P([]),k({}))},[t,I.current]),V=(0,a.useCallback)(()=>{"string"==typeof t&&t.length>0&&I.current?(I.current.setAuth(t),I.current.getSchedules().then(e=>{N(e.data)})):N([])},[t,I.current]),J=(0,a.useCallback)(()=>{"string"==typeof t&&t.length>0&&I.current?(I.current.setAuth(t),I.current.getNotifications().then(e=>{D(e)})):N([])},[t,I.current]),K=(0,a.useCallback)(()=>{"string"==typeof t&&t.length>0&&I.current&&(I.current.setAuth(t),I.current.markAllAsReadNotification().then(e=>{J()}))},[t,I.current]),X=(0,a.useCallback)(async(e,t)=>{try{await I.current.createSchedule({contactId:e.contactId,scheduledFor:e.userId,sectorId:e.sectorId,date:t}),u.oR.success("Agendamento criado com sucesso!")}catch(e){u.oR.error("Falha ao criar agendamento\n"+(0,c.sanitizeErrorMessage)(e)),console.error("Falha ao criar agendamento",e)}},[]),H=(0,a.useCallback)(()=>{"string"==typeof t&&t.length>0&&I.current?(I.current.setAuth(t),I.current.getChatsBySession(!0,!0).then(({chats:e,messages:t})=>{let{chatsMessages:r,detailedChats:s}=i(e,t);g(s),k(r)}),I.current.getSectors().then(e=>R(e))):(g([]),k({}))},[t,I.current]);return(0,s.jsx)(p.Provider,{value:{chats:f,messages:v,currentChat:C,currentChatMessages:b,openChat:O,setCurrentChat:A,finishChat:z,startChatByContactId:B,sendMessage:G,setCurrentChatMessages:y,wppApi:I,chatFilters:L,changeChatFilters:$,updateChatContact:U,sectors:w,currentChatRef:j,transferAttendance:W,getChatsMonitor:_,monitorChats:S,getChats:H,createSchedule:X,getMonitorSchedules:V,monitorSchedules:E,notifications:M,getNotifications:J,markAllAsReadNotification:K,templates:T},children:e})}let x=()=>{let e=(0,a.useContext)(p);if(!e)throw Error("useWhatsappContext must be used within a WhatsappProvider");return e}},55620:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,m:()=>c});var s=r(60687),a=r(89193),n=r(43210),o=r(30601),l=r(93853);let i=(0,n.createContext)({}),c=()=>(0,n.useContext)(i);function d({children:e}){let{token:t}=(0,n.useContext)(o.c),[r,c]=(0,n.useState)([]),d=(0,n.useRef)(new a.ReadyMessageClient("https://inpulse.infotecrs.inf.br")),u=[{name:"@sauda\xe7\xe3o_tempo",replaceFor:"currentSaudation"},{name:"@cliente_razao",replaceFor:"customerRazao"},{name:"@cliente_cnpj",replaceFor:"customerCnpj"},{name:"@atendente_nome",replaceFor:"operatorName"},{name:"@atendente_nome_exibicao",replaceFor:"operatorNameExibition"},{name:"@contato_primeiro_nome",replaceFor:"customerFirstName"},{name:"@contato_nome_completo",replaceFor:"customerFullName"}],h=(0,n.useCallback)(async(e,r,s)=>{if(t)try{if(!s)return;let t=await d.current.updateReadyMessage(e,r,s);c(r=>r.map(r=>r.CODIGO===e?{...r,file:t.ARQUIVO}:r)),l.oR.success("Arquivo do Mensagem pronta atualizada com sucesso!")}catch(e){console.error("Error updating readyMessage image",e),l.oR.error("Erro ao atualizar Arquivo do Mensagem pronta")}},[t]),p=(0,n.useCallback)(async(e,r,s,a)=>{if(t)try{let t=await d.current.createReadyMessage(e,r,s,a);c(e=>[t,...e||[]])}catch(e){console.error("Error creating readyMessage",e),l.oR.error("Erro ao criar Mensagem pronta")}},[t]),m=(0,n.useCallback)(async e=>{if(t)try{await d.current.deleteReadyMessage(e),l.oR.success("Mensagem pronta  deletado com sucesso!"),c(t=>t.filter(t=>t.CODIGO!==e))}catch(e){l.oR.error("Erro ao deletar Mensagem pronta")}},[t]),x=(0,n.useCallback)(async()=>{t&&d.current&&(d.current.setAuth(t),c(await d.current.getReadyMessages()))},[t]);return(0,s.jsx)(i.Provider,{value:{readyMessages:r,updateReadyMessage:h,createReadyMessage:p,deleteReadyMessage:m,variables:u,replaceVariables:function({message:e,values:t}){return u.forEach(r=>{e=e.replaceAll(r.name,t[r.replaceFor])}),e},fetchReadyMessages:x},children:e})}},61135:()=>{},62436:(e,t,r)=>{Promise.resolve().then(r.bind(r,26398))},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(31658);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},73620:(e,t,r)=>{"use strict";r.d(t,{pI:()=>c,Ay:()=>u,qw:()=>d});var s=r(60687),a=r(43210),n=r(89193),o=r(30601),l=r(44366),i=r(93853);let c=(0,a.createContext)({}),d=()=>(0,a.useContext)(c);function u({children:e}){let t=(0,a.useRef)(new n.CustomersClient("https://inpulse.infotecrs.inf.br")),{token:r}=(0,o.Z)(),[d,u]=(0,a.useReducer)(function e(t,r){let s={...t};switch(r.type){case"change-loading":return{...s,isLoading:r.isLoading};case"change-page":return s.filters.page=r.page.toString(),s;case"change-per-page":return s.filters.perPage=r.perPage.toString(),s;case"change-total-rows":return s.totalRows=r.totalRows,{...s,totalRows:r.totalRows};case"change-filters":return s.filters={page:t.filters.page,perPage:t.filters.perPage,...r.filters},s;case"load-customers":return s.customers=r.customers,s;case"update-customer":return{...s,customers:s.customers.map(e=>e.CODIGO===r.id?{...e,...r.data}:e)};case"add-customer":return s.customers.unshift(r.data),s;case"multiple":let a={...t};for(let t of r.actions)a=e(a,t);return a;default:return s}},{customers:[],totalRows:0,filters:{},isLoading:!1}),h=(0,a.useCallback)(async e=>{try{r&&(await t.current.createCustomer(e),i.oR.success("Cliente cadastrado com sucesso!"))}catch(e){l.Logger.error("Error creating customer",e),i.oR.error("Falha ao cadastrar cliente!")}finally{m()}},[r]),p=(0,a.useCallback)(async(e,s)=>{try{r&&(await t.current.updateCustomer(e,s),u({type:"update-customer",id:e,data:s}),i.oR.success("Cliente atualizado com sucesso!"))}catch(e){l.Logger.error("Error updating customer",e),i.oR.error("Falha ao atualizar cliente!")}},[r]),m=(0,a.useCallback)(async()=>{u({type:"change-loading",isLoading:!0});try{let e=await t.current.getCustomers(d.filters);u({type:"multiple",actions:[{type:"change-total-rows",totalRows:e.page.totalRows},{type:"change-loading",isLoading:!1},{type:"load-customers",customers:e.data}]})}catch(e){u({type:"change-loading",isLoading:!1}),l.Logger.error("Error loading customers",e),i.oR.error("Falha ao carregar clientes!")}},[]);return(0,s.jsx)(c.Provider,{value:{state:d,dispatch:u,updateCustomer:p,createCustomer:h,loadCustomers:m},children:e})}},75940:(e,t,r)=>{Promise.resolve().then(r.bind(r,7342))},81185:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,86346,23)),Promise.resolve().then(r.t.bind(r,27924,23)),Promise.resolve().then(r.t.bind(r,35656,23)),Promise.resolve().then(r.t.bind(r,40099,23)),Promise.resolve().then(r.t.bind(r,38243,23)),Promise.resolve().then(r.t.bind(r,28827,23)),Promise.resolve().then(r.t.bind(r,62763,23)),Promise.resolve().then(r.t.bind(r,97173,23))},81449:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=function(e,t){return"PENDING"===e?t:"SENT"===e&&"PENDING"===t||"RECEIVED"===e&&["SENT","PENDING"].includes(t)||"READ"===e&&["SENT","PENDING","RECEIVED"].includes(t)?e:t}},92177:(e,t,r)=>{"use strict";r.d(t,{default:()=>a});var s=r(12907);(0,s.registerClientReference)(function(){throw Error("Attempted to call AuthContext() from the server but AuthContext is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\projects\\infotec\\inpulse\\inpulse-frontend\\src\\app\\auth-context.tsx","AuthContext"),(0,s.registerClientReference)(function(){throw Error("Attempted to call useAuthContext() from the server but useAuthContext is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\projects\\infotec\\inpulse\\inpulse-frontend\\src\\app\\auth-context.tsx","useAuthContext");let a=(0,s.registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\projects\\\\infotec\\\\inpulse\\\\inpulse-frontend\\\\src\\\\app\\\\auth-context.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\projects\\infotec\\inpulse\\inpulse-frontend\\src\\app\\auth-context.tsx","default")},94431:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c,metadata:()=>i});var s=r(37413),a=r(78483),n=r.n(a);r(61135);var o=r(81819),l=r(92177);let i={title:"InPulse"};function c({children:e}){return(0,s.jsx)("html",{lang:"pt-br",children:(0,s.jsx)("body",{suppressHydrationWarning:!0,className:`${n().variable} relative bg-fixed text-slate-200`,children:(0,s.jsxs)(l.default,{children:[e,(0,s.jsx)(o.ToastContainer,{position:"bottom-center",autoClose:6e3,newestOnTop:!0,draggable:!0,theme:"dark",transition:o.Bounce})]})})})}},97015:(e,t,r)=>{"use strict";r.d(t,{xI:()=>u,l1:()=>p,Ay:()=>h});var s=r(60687),a=r(43210),n=r(89193),o=r(30601),l=r(35118);r(81449),r(20311),r(30594),r(44366),r(27807);var i=r(52171),c=r(93853),d=r(51918);let u=(0,a.createContext)({});function h(){let e=(0,a.useContext)(u);if(!e)throw Error("useInternalChatContext must be used within an InternalChatProvider");return e}function p({children:e}){let{socket:t}=(0,a.useContext)(l.d),{setCurrentChat:r,currentChatRef:h,setCurrentChatMessages:p,chats:m}=(0,i.jb)(),[x,f]=(0,a.useState)([]),[g,C]=(0,a.useState)([]),[A,j]=(0,a.useState)({}),[b,y]=(0,a.useState)([]),[v,k]=(0,a.useState)({}),{contacts:w}=(0,a.useContext)(d.Jj),[R,I]=(0,a.useState)([]),S=(0,a.useRef)(new n.InternalChatClient("https://inpulse.infotecrs.inf.br")),{token:P,user:E}=(0,a.useContext)(o.c),N=(0,a.useCallback)((e,t=!0)=>{r(e),I(A[e.id]||v[e.id]||[]),p([]),h.current=e,t&&(S.current.markChatMessagesAsRead(e.id),f(t=>t.map(t=>t.id===e.id?{...t,isUnread:!1}:t)))},[A]),M=async e=>{if(S.current)try{await S.current.deleteInternalChat(e),c.oR.success("Chat deletado com sucesso!"),f(t=>t.filter(t=>t.id!==e))}catch(e){c.oR.error("Erro ao deletar Chat")}},D=(0,a.useCallback)(e=>{P&&(S.current.setAuth(P),S.current.sendMessageToInternalChat(e))},[P]),T=(0,a.useCallback)(e=>{P&&E&&S.current.createInternalChat([e,E.CODIGO],!1,"")},[S,P,E]),F=(0,a.useCallback)(()=>{P&&E&&g.length>0?(S.current.setAuth(P),S.current.getInternalChatsMonitor().then(({chats:e,messages:t})=>{console.log("Monitorando conversas internas",e,t);let{chatsMessages:r,detailedChats:s}=function(e,t,r,s){let a=new Map;r.forEach(e=>a.set(e.id,e)),s.sort((e,t)=>(e.timestamp||0)<(t.timestamp||0)?-1:1);let n={},o={};for(let t of s){let r=a.get(t.internalChatId),s=r?.participants.find(t=>t.userId===e);if(s&&s.lastReadAt){let r=new Date(s.lastReadAt).getTime(),a=+t.timestamp,n=t.from===`user:${e}`;r>=a&&"READ"!==t.status&&!n&&(t.status="READ")}o[t.internalChatId]||(o[t.internalChatId]=[]),o[t.internalChatId].push(t),(!n[t.internalChatId]||t.timestamp>n[t.internalChatId].timestamp)&&(n[t.internalChatId]=t)}let l=t=>t.from===`user:${e}`,i=(e,t)=>t.id===e.internalChatId,c=r.map(e=>({...e,chatType:"internal",isUnread:s.some(t=>i(t,e)&&!l(t)&&"READ"!==t.status),lastMessage:n[e.id]||null,users:t.filter(t=>e.participants.some(e=>e.userId===t.CODIGO))}));return c.sort((e,t)=>(e.lastMessage?.timestamp||0)<(t.lastMessage?.timestamp||0)?1:-1),{detailedChats:c,chatsMessages:o}}(E.CODIGO,g,e||[],t||[]);y(s||[]),k(r||[])})):(f([]),k({}))},[P,S.current,E,g]);return(0,s.jsx)(u.Provider,{value:{internalApi:S,internalChats:x,messages:A,setCurrentChat:r,sendInternalMessage:D,startDirectChat:T,openInternalChat:N,currentInternalChatMessages:R,users:g,monitorInternalChats:b,getInternalChatsMonitor:F,monitorMessages:v,deleteInternalChat:M},children:e})}},98330:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(51052).A)({palette:{mode:"dark"}})}};