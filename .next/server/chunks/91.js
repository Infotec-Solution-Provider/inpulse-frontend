exports.id=91,exports.ids=[91],exports.modules={23566:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>c,uk:()=>u});var l=s(60687),n=s(43210),r=s(52171),o=s(97015),i=s(30601);let d={categories:{showCustomerChats:!0,showInternalChats:!0,showInternalGroups:!0,showSchedules:!0},user:"all",showBots:!1,showOngoing:!0,showFinished:!0,showOnlyScheduled:!1,startedAt:{from:null,to:null},finishedAt:{from:null,to:null},scheduledAt:{from:null,to:null},scheduledTo:{from:null,to:null},scheduledBy:"all",scheduledFor:"all"},a=(0,n.createContext)({});function u({children:e}){let{monitorChats:t,getChatsMonitor:s,getMonitorSchedules:u,monitorSchedules:c}=(0,r.jb)(),{monitorInternalChats:h,getInternalChatsMonitor:f}=(0,o.Ay)(),{token:m}=(0,n.useContext)(i.c),[p,A]=(0,n.useState)(d),x=(0,n.useMemo)(()=>{let e=h.filter(e=>{if(e.isGroup&&!p.categories.showInternalGroups||!e.isGroup&&!p.categories.showInternalChats||"all"!==p.user&&!e.participants.some(e=>e.userId===p.user)||p.showOnlyScheduled)return!1;let t=new Date(e.startedAt);return!(p.startedAt.from&&t<new Date(p.startedAt.from)||p.startedAt.to&&t>new Date(p.startedAt.to))});return[...e,...t.filter(e=>{if(!p.categories.showCustomerChats||"all"!==p.user&&e.userId!==p.user||!p.showBots&&null!==e.botId||p.showOnlyScheduled&&!e.isSchedule)return!1;let t=null===e.finishedAt&&null!==e.startedAt,s=null!==e.finishedAt;return!(!p.showOngoing&&!p.showFinished||p.showOngoing&&!p.showFinished&&!t||!p.showOngoing&&p.showFinished&&!s||p.startedAt.from&&new Date(e.startedAt)<new Date(p.startedAt.from)||p.startedAt.to&&new Date(e.startedAt)>new Date(p.startedAt.to)||p.finishedAt.from&&e.finishedAt&&new Date(e.finishedAt)<new Date(p.finishedAt.from)||p.finishedAt.to&&e.finishedAt&&new Date(e.finishedAt)>new Date(p.finishedAt.to)||p.scheduledAt.from&&e.schedule?.scheduledAt&&new Date(e.schedule.scheduledAt)<new Date(p.scheduledAt.from)||p.scheduledAt.to&&e.schedule?.scheduledAt&&new Date(e.schedule.scheduledAt)>new Date(p.scheduledAt.to)||p.scheduledTo.from&&e.schedule?.scheduleDate&&new Date(e.schedule.scheduleDate)<new Date(p.scheduledTo.from)||p.scheduledTo.to&&e.schedule?.scheduleDate&&new Date(e.schedule.scheduleDate)>new Date(p.scheduledTo.to))}),...c.filter(e=>!(!p.categories.showSchedules||"all"!==p.scheduledBy&&e.scheduledBy!==p.scheduledBy||"all"!==p.scheduledFor&&e.scheduledFor!==p.scheduledFor||p.scheduledAt.from&&new Date(e.scheduledAt)<new Date(p.scheduledAt.from)||p.scheduledAt.to&&new Date(e.scheduledAt)>new Date(p.scheduledAt.to)))].sort((e,t)=>{let s=e=>new Date("startedAt"in e&&e.startedAt?e.startedAt:"scheduledAt"in e&&e.scheduledAt?e.scheduledAt:0),l=s(e),n=s(t);return l.getTime()-n.getTime()})},[t,h,p]);return(0,l.jsx)(a.Provider,{value:{chats:x,filters:p,setFilters:A,resetFilters:()=>{A(d)}},children:e})}function c(){let e=(0,n.useContext)(a);if(!e)throw Error("useMonitorContext must be used within a MonitorProvider");return e}},27017:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var l=s(60687),n=s(23566);function r({children:e}){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(n.uk,{children:e})})}},44617:(e,t,s)=>{"use strict";function l(e){return e?("string"==typeof e&&(e=new Date(e)),!(e instanceof Date)||isNaN(e.getTime()))?"N/D":e.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}):"N/D"}s.d(t,{A:()=>l})},67587:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});let l=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\projects\\\\infotec\\\\inpulse\\\\inpulse-frontend\\\\src\\\\app\\\\(private)\\\\[instance]\\\\monitor\\\\layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\projects\\infotec\\inpulse\\inpulse-frontend\\src\\app\\(private)\\[instance]\\monitor\\layout.tsx","default")},75396:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var l=s(23428),n=s(60687);let r=(0,l.A)((0,n.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},78878:(e,t,s)=>{"use strict";s.d(t,{A:()=>M});var l=s(60687),n=s(43210),r=s(52171),o=s(97015),i=s(30601),d=s(99441),a=s(93108),u=s(61339);function c(e){return e.from.startsWith("system")?"system":e.from.startsWith("me:")||e.from.startsWith("bot:")?"sent":"received"}function h(){let{currentChatMessages:e,currentChat:t}=(0,r.jb)(),{getMessageById:s,handleQuoteMessage:o}=(0,n.useContext)(u.U),{instance:h}=(0,n.useContext)(i.c),f="nunes"===h?(()=>{let t=[...e].map(e=>!!("system"===e.from&&e.body?.startsWith("Atendimento transferido"))).lastIndexOf(!0);return -1!==t?e.slice(t):e})():e;return(0,l.jsx)(l.Fragment,{children:f.map(e=>{let n=e.contactId&&e.quotedId&&s(e.contactId,e.quotedId),r=n?(0,d.A)(n,c(n),[],t):null;return(0,l.jsx)(a.Ay,{id:e.id,style:c(e),text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,quotedMessage:r,onQuote:()=>{o(e)}},`message_${e.id}`)})})}var f=s(78231),m=s(57810),p=s(51918),A=s(16184),x=s(87088),w=s(37204),g=s(24296),y=s(83685),D=s(90764),C=s(45525),j=s(17181),I=s(64216),v=s(93010),b=s(9134);function S(){let{currentInternalChatMessages:e,users:t,sendInternalMessage:s}=(0,n.useContext)(o.xI),{getMessageById:r,handleQuoteMessage:a}=(0,n.useContext)(u.U),{user:c}=(0,i.Z)(),{contacts:h}=(0,n.useContext)(p.Jj),[f,S]=(0,n.useState)(new Set),[M,O]=(0,n.useState)(!1),[N,T]=(0,n.useState)(null),[F,k]=(0,n.useState)(30),G=(0,n.useMemo)(()=>{let e=new Map;for(let s of t)e.set(s.CODIGO,s);return e},[t]),W=(0,n.useMemo)(()=>{let e=new Map;for(let t of h){let s=t.phone?.replace(/\D/g,"");s&&e.set(s,t.name)}return e},[h]),z=(0,n.useMemo)(()=>{let e=new Map;for(let s of t){let t=s.WHATSAPP?.replace(/\D/g,"");t&&e.set(t,s.NOME)}for(let t of h){let s=t.phone?.replace(/\D/g,"");s&&!e.has(s)&&e.set(s,t.name)}return e},[t,h]),E=(0,n.useCallback)(e=>{S(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},[]),P=()=>{S(new Set)},B=(0,n.useMemo)(()=>e.filter(e=>f.has(e.id)),[e,f]),q=(0,n.useMemo)(()=>e.slice(-F),[e,F]);function R(e,t){return"system"===e.from?"system":e.from===`user:${t}`?"sent":"received"}let H=e=>{for(let t of N||B)s({chatId:e,text:t.body,fileId:t.fileId??void 0,sendAsAudio:!1,sendAsDocument:!1,mentions:[],quotedId:null});O(!1),T(null),P()},L=e=>{T([e]),O(!0)};return(0,l.jsxs)("div",{className:"relative h-full overflow-y-auto p-2",children:[F<e.length&&(0,l.jsx)("div",{className:"flex justify-center mb-2",children:(0,l.jsx)(A.A,{variant:"outlined",size:"small",onClick:()=>k(t=>Math.min(t+30,e.length)),children:"Carregar mais"})}),f.size>0&&(0,l.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 shadow p-2 flex items-center justify-between",children:[(0,l.jsxs)(x.A,{variant:"subtitle1",component:"div",children:[f.size," mensagem(s) selecionada(s)"]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)(A.A,{variant:"outlined",onClick:P,children:"Cancelar"}),(0,l.jsx)(A.A,{variant:"contained",onClick:()=>O(!0),children:"Encaminhar"})]})]}),(0,l.jsx)("ul",{className:"flex flex-col gap-2 pt-[48px]",children:q.map((e,s,n)=>{let o=e.internalChatId&&e.quotedId&&r(e.internalChatId,e.quotedId,!0),i=o?(0,d.A)(o,R(o,c.CODIGO),t,null,W):null,u=s>0?n[s-1]:null,h=!u||u.from!==e.from,p=null;if(e.from.startsWith("user:")){let t=Number(e.from.split(":")[1]),s=G.get(t);p=s?s.NOME:null}if(e.from.startsWith("external:")){let t=e.from.split(":"),s="";3===t.length?s=t[2]:2===t.length&&(s=t[1]);let l=s.split("@")[0].replace(/\D/g,""),n=G.get(l);if(n)p=n.NOME;else{let e=W.get(l);p=e||(l?(l.length,l):"Sem n\xfamero")}}return(0,l.jsx)(m.A,{id:e.id,style:R(e,c.CODIGO),groupFirst:h,sentBy:p||"Desconhecido",text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,quotedMessage:i,onQuote:()=>a(e),mentionNameMap:z,isForwardMode:f.size>0,isSelected:f.has(e.id),onSelect:E,onForward:()=>L(e),onCopy:()=>navigator.clipboard.writeText(e.body)},e.id)})}),(0,l.jsxs)(w.A,{open:M,onClose:()=>O(!1),maxWidth:"xs",fullWidth:!0,children:[(0,l.jsxs)(g.A,{children:["Encaminhar para...",(0,l.jsx)(y.A,{"aria-label":"fechar",onClick:()=>O(!1),sx:{position:"absolute",right:8,top:8},children:(0,l.jsx)(b.A,{})})]}),(0,l.jsx)(D.A,{dividers:!0,children:(0,l.jsx)(C.A,{children:t.map(e=>(0,l.jsx)(j.Ay,{disablePadding:!0,children:(0,l.jsx)(I.A,{onClick:()=>H(e.CODIGO),children:(0,l.jsx)(v.A,{primary:e.NOME,secondary:e.EMAIL||e.WHATSAPP})})},e.CODIGO))})})]})]})}function M(){let{currentChatMessages:e,currentChat:t}=(0,n.useContext)(r.ce),{currentInternalChatMessages:s}=(0,n.useContext)(o.xI),{user:d}=(0,n.useContext)(i.c),a=t?.chatType==="wpp",u=t?.chatType==="internal"&&!t.isGroup,c=t?.chatType==="internal"&&t.isGroup,m=(0,n.useRef)(null),p=(0,n.useRef)(null);return(0,l.jsx)(l.Fragment,{children:d&&(0,l.jsxs)("ul",{className:"flex flex-col flex-1 w-full gap-2 scrollbar-whatsapp bg-slate-300 dark:bg-slate-700 p-2 min-h-[calc(100vh-165px)] md:mt-0 mt-7 overflow-y-auto",ref:m,children:[a&&(0,l.jsx)(h,{}),u&&(0,l.jsx)(f.A,{}),c&&(0,l.jsx)(S,{}),(0,l.jsx)("li",{ref:p,className:"h-0"})]})})}},81956:(e,t,s)=>{Promise.resolve().then(s.bind(s,67587))},95460:(e,t,s)=>{Promise.resolve().then(s.bind(s,27017))}};