"use strict";exports.id=790,exports.ids=[790],exports.modules={18157:(e,t,s)=>{s.d(t,{A:()=>g});var l=s(60687),a=s(63952),r=s(43210),n=s(1588),i=s(12039),o=s(16184),c=s(8734),d=s(47651),x=s(83685),m=s(27736),u=s(1491),h=s(9134),p=s(32629);let f=[50,75,100,125,150,200,300];function g({fileName:e,fileType:t,fileSize:s,fileId:g}){let{closeModal:j,openModal:b}=(0,r.useContext)(i.BR),A=()=>{let t=a.A.getFileDownloadUrl(g);b((0,l.jsx)(N,{url:t,alt:e,onClose:j}))};function N({url:e,alt:t,onClose:s}){let[a,n]=(0,r.useState)(1),[i,g]=(0,r.useState)({x:0,y:0}),j=(0,r.useRef)(null),b=(0,r.useRef)(null),[A,N]=(0,r.useState)(null),v=Math.round(100*a),y=e=>{if(!j.current)return;e.preventDefault();let t=e.clientX-j.current.x,s=e.clientY-j.current.y;g(e=>({x:e.x+t,y:e.y+s})),j.current={x:e.clientX,y:e.clientY}},w=e=>{j.current=null,window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",w)},C=e=>{n(e/100),g({x:0,y:0}),N(null)};return(0,l.jsxs)("div",{className:"fixed inset-0 flex flex-col bg-black bg-opacity-90 text-white z-50 items-center justify-center p-4",style:{userSelect:"none"},children:[(0,l.jsxs)("header",{className:"w-full max-w-[95vw] flex justify-between items-center mb-2",children:[(0,l.jsxs)(o.A,{variant:"outlined",onClick:e=>{N(e.currentTarget)},sx:{color:"white",borderColor:"white",minWidth:70,fontWeight:"bold"},children:[v,"%"]}),(0,l.jsx)(c.A,{anchorEl:A,open:!!A,onClose:()=>{N(null)},PaperProps:{style:{backgroundColor:"#222",color:"white",minWidth:80}},children:f.map(e=>(0,l.jsxs)(d.A,{selected:e===v,onClick:()=>C(e),sx:{"&.Mui-selected":{backgroundColor:"rgba(255,255,255,0.2)"}},children:[e,"%"]},e))}),(0,l.jsx)(x.A,{onClick:s,sx:{color:"white"},children:(0,l.jsx)(h.A,{})})]}),(0,l.jsxs)("div",{ref:b,onWheel:e=>{e.preventDefault();let t=-e.deltaY/500;n(s=>{let l=Math.min(3,Math.max(.5,s+t));if(l!==s&&b.current){let t=b.current.getBoundingClientRect(),a=e.clientX-t.left-t.width/2-i.x,r=e.clientY-t.top-t.height/2-i.y;g(e=>({x:e.x-a*(l/s-1),y:e.y-r*(l/s-1)}))}return l})},onMouseDown:e=>{1!==a&&(e.preventDefault(),j.current={x:e.clientX,y:e.clientY},window.addEventListener("mousemove",y),window.addEventListener("mouseup",w))},className:"relative bg-black rounded max-w-[95vw] max-h-[85vh] overflow-hidden flex justify-center items-center cursor-grab",style:{flexGrow:1,width:"100%"},children:[(0,l.jsx)("img",{src:e,alt:t,draggable:!1,style:{transform:`translate(${i.x}px, ${i.y}px) scale(${a})`,transition:"transform 0.1s ease-out",maxWidth:"100%",maxHeight:"85vh",objectFit:"contain",cursor:1===a?"zoom-in":"grab",userSelect:"none"}}),(0,l.jsxs)("div",{className:"absolute bottom-3 right-3 flex items-center gap-2 bg-black bg-opacity-60 rounded p-1",style:{userSelect:"none"},children:[(0,l.jsx)(x.A,{onClick:()=>n(e=>Math.min(e+.25,3)),sx:{color:"white",bgcolor:"transparent",borderRadius:1,padding:0,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.2)"}},"aria-label":"Zoom In",size:"small",children:(0,l.jsx)(m.A,{})}),(0,l.jsx)(x.A,{onClick:()=>n(e=>Math.max(e-.25,.5)),sx:{color:"white",bgcolor:"transparent",borderRadius:1,padding:0,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.2)"}},"aria-label":"Zoom Out",size:"small",children:(0,l.jsx)(u.A,{})}),(0,l.jsx)(x.A,{onClick:()=>{n(1),g({x:0,y:0})},sx:{color:"white",width:36,height:36,borderRadius:1,padding:0,bgcolor:"transparent","&:hover":{bgcolor:"rgba(255, 255, 255, 0.2)"}},"aria-label":"Reset Zoom",size:"small",children:(0,l.jsx)(p.A,{fontSize:"small"})})]})]})]})}let v=(0,r.useMemo)(()=>{let r=a.A.getFileDownloadUrl(g);return t.includes("image")?(0,l.jsx)("img",{src:r,alt:e,className:"max-h-[20rem] max-w-[40rem] cursor-zoom-in sm:max-w-[100%] sm:max-h-[15rem]",onClick:A}):t.includes("video")?(0,l.jsx)("video",{controls:!0,className:"max-h-[15rem] max-w-[40rem] sm:max-w-full sm:max-h-[10rem] object-contain",children:(0,l.jsx)("source",{src:r,type:t})}):t.includes("audio")?(0,l.jsx)("audio",{controls:!0,children:(0,l.jsx)("source",{src:r,type:t})}):(0,l.jsxs)("a",{href:r,target:"_blank",rel:"noreferrer",className:"flex h-16 w-52 items-center justify-center gap-2 hover:text-indigo-500",children:[(0,l.jsx)(n.A,{}),(0,l.jsxs)("p",{children:[" (",(()=>{let e=parseInt(s,10);return e<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(2)} KB`:`${(e/1048576).toFixed(2)} MB`})(),")"]})]})},[g,e,t,s]);return(0,l.jsx)("div",{children:v})}},32832:(e,t,s)=>{s.d(t,{A:()=>P});var l=s(60687),a=s(43210),r=s(83685),n=s(60997),i=s(33245),o=s(77282),c=s(83260),d=s(24619),x=s(28088),m=s(9134),u=s(51289),h=s(52171),p=s(61339),f=s(30601),g=s(83281),j=s(88560);let b=e=>{let t=Math.floor(e/60);return`${String(t).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`};function A({onAudioRecorded:e}){let[t,s]=(0,a.useState)(!1),n=(0,a.useRef)(null),i=(0,a.useRef)([]),o=(0,a.useRef)(null),[c,d]=(0,a.useState)(0),x=async()=>{try{let t=await navigator.mediaDevices.getUserMedia({audio:!0}),l=new MediaRecorder(t);n.current=l,l.ondataavailable=e=>{i.current.push(e.data)},l.onstop=()=>{let t=new Blob(i.current,{type:"audio/mpeg"});if(i.current=[],e){let s=new File([t],"audio.mp3",{type:"audio/mpeg"});e(s)}},l.start(),s(!0),d(0),o.current=setInterval(()=>{d(e=>e+1)},1e3)}catch(e){console.error("Erro ao acessar o microfone:",e)}};return(0,l.jsxs)("div",{className:"pr-2 flex items-center gap-2",children:[t?(0,l.jsx)(r.A,{color:"error",onClick:()=>{n.current?.stop(),s(!1)},size:"small",children:(0,l.jsx)(j.A,{})}):(0,l.jsx)(r.A,{color:"primary",onClick:x,size:"small",children:(0,l.jsx)(g.A,{})}),t&&(0,l.jsx)("span",{className:"text-sm text-slate-400",children:b(c)})]})}var N=s(93853),v=s(37204),y=s(24296),w=s(90764),C=s(45525),k=s(64216),I=s(93010),O=s(87088),E=s(27674),M=s(16184),S=s(97015),R=s(55620);let D=({chat:e,onClose:t})=>{let{readyMessages:s,replaceVariables:n,fetchReadyMessages:i}=(0,R.m)(),{user:o}=(0,a.useContext)(f.c),{sendMessage:c}=(0,a.useContext)(h.ce),{sendInternalMessage:d}=(0,a.useContext)(S.xI),[x,u]=(0,a.useState)(null),p={currentSaudation:(()=>{let e=new Date().getHours();return e>=5&&e<12?"Bom dia":e>=12&&e<18?"Boa tarde":"Boa noite"})(),operatorName:o?.NOME||"",operatorNameExibition:o?.NOME_EXIBICAO||o?.NOME||""},g="chatType"in e?{customerCnpj:e.customer?.CPF_CNPJ||"",customerFirstName:e.customer?.FANTASIA?.split(" ")[0]||"",customerFullName:e.customer?.RAZAO||"",customerRazao:e.customer?.RAZAO||""}:{groupName:e.groupName||"",customerCnpj:"",customerFirstName:"",customerFullName:"",customerRazao:""},j=n({message:x?.TEXTO_MENSAGEM||"",values:{...p,...g}}),b=async()=>{if(!x||!o){N.oR.error("Falha ao enviar mensagem");return}try{"wpp"===e.chatType?await c(e.contact?.phone??"",{chatId:e.id,contactId:e.contactId??0,text:j,fileId:+x.ARQUIVO_CODIGO}):await d({chatId:e.id,text:j,fileId:+x.ARQUIVO_CODIGO}),N.oR.success("Mensagem enviada com sucesso!"),t()}catch(e){N.oR.error("Erro ao enviar mensagem")}};return(0,a.useEffect)(()=>{i()},[]),(0,l.jsxs)(v.A,{open:!0,onClose:t,fullWidth:!0,maxWidth:"sm",children:[(0,l.jsxs)(y.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Mensagens r\xe1pidas",(0,l.jsx)(r.A,{onClick:t,children:(0,l.jsx)(m.A,{})})]}),(0,l.jsx)(w.A,{dividers:!0,children:s&&s.length?(0,l.jsx)(C.A,{children:s?.map(e=>l.jsx(k.A,{selected:x?.CODIGO===e.CODIGO,onClick:()=>u(e),sx:{borderRadius:2,mb:1,border:x?.CODIGO===e.CODIGO?"1px solid #1976d2":"1px solid transparent",backgroundColor:x?.CODIGO===e.CODIGO?"rgba(25, 118, 210, 0.1)":"transparent",transition:"all 0.2s","&:hover":{backgroundColor:"rgba(25, 118, 210, 0.08)"}},children:l.jsx(I.A,{primary:l.jsx(O.A,{variant:"body2",color:"textPrimary",noWrap:!0,children:e.TEXTO_MENSAGEM})})},e.CODIGO))}):(0,l.jsx)(O.A,{variant:"body2",color:"textSecondary",children:"Nenhuma mensagem cadastrada."})}),(0,l.jsx)(E.A,{children:(0,l.jsx)(M.A,{onClick:b,disabled:!x,variant:"contained",color:"primary",children:"Enviar"})})]})};var T=s(78231),$=s(51918),z=s(44366);function P(){let{currentChat:e}=(0,a.useContext)(h.ce),{sendMessage:t,state:s,dispatch:g,quotedMessage:j,handleQuoteMessageRemove:b}=(0,a.useContext)(p.U),{user:N}=(0,a.useContext)(f.c),{users:v}=(0,a.useContext)(S.xI),{contacts:y}=(0,a.useContext)($.Jj),w=(0,a.useRef)(null),C=(0,a.useRef)(null),k=!e,[I,O]=(0,a.useState)(!1),[E,M]=(0,a.useState)(!1),{textWithNames:R,setTextWithNames:P,handleTextChange:F,selectMention:G,mentionCandidates:B,showMentionList:W}=function({stateText:e,mentions:t,participants:s,users:l,contacts:r,dispatch:n}){let[i,o]=(0,a.useState)(""),[c,d]=(0,a.useState)(""),[x,m]=(0,a.useState)([]),[u,h]=(0,a.useState)(!1),p=(0,a.useMemo)(()=>{let e=new Map;for(let t of l)e.set(t.CODIGO,t);return e},[l]),f=(0,a.useMemo)(()=>{let e=new Map;for(let t of l){let s=t.WHATSAPP?.replace(/\D/g,"");s&&e.set(s,t)}return e},[l]),g=(0,a.useMemo)(()=>{let e=new Map;for(let t of r){let s=t.phone?.replace(/\D/g,"");s&&e.set(s,t.name)}return e},[r]);return{textWithNames:i,setTextWithNames:o,mentionCandidates:x,showMentionList:u,handleTextChange:e=>{o(e);let l=e;t.forEach(e=>{let t=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=RegExp(`@${t}`,"g");l=l.replace(s,`@${e.phone}`)}),n({type:"change-text",text:l});let a=e.match(/@(\w*)$/);a&&s.length>0?(d(a[1]),m(s.map(e=>{let t=String(e.userId);if(t.length>8){let e=t.replace(/\D/g,""),s=f.get(e);if(s)return{userId:Number(t),name:s.NOME,phone:e};let l=g.get(e);return{userId:Number(t),name:l||z.Formatter.phone(e),phone:e}}{let e=Number(t),s=p.get(e);return s?{userId:e,name:s.NOME,phone:s.WHATSAPP||""}:null}}).filter(e=>!!e)),h(!0)):(m([]),h(!1),d(""))},selectMention:(e,s,l)=>{let a=s.lastIndexOf(`@${c}`,l),r=s.substring(0,a),i=s.substring(l),x=`${r}@${e.name} ${i}`;o(x);let m=x,u=[...t.filter(t=>t.userId!==e.userId),e];return u.forEach(e=>{let t=e.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=RegExp(`@${t}`,"g");m=m.replace(s,`@${e.phone}`)}),n({type:"change-text",text:m}),n({type:"set-mentions",mentions:u}),d(""),h(!1),{newTextWithNames:x,cursorPosition:r.length+e.name.length+2}}}}({stateText:s.text,mentions:s.mentions||[],participants:e?.participants||[],users:v,contacts:y,dispatch:g}),q=(0,a.useCallback)(e=>g({type:"add-emoji",emoji:e.emoji}),[g]);return(0,a.useMemo)(()=>{let e;return j?.from.includes("user:")&&N&&(e=j)&&"internalChatId"in e?(0,T._)(j,N.CODIGO):j?.from.includes("external:")?"received":j?.from.startsWith("me:")?"sent":"received"},[j,N]),(0,l.jsxs)("div",{className:"flex max-h-36 items-center gap-2 bg-slate-200 px-2 py-2 text-indigo-300 dark:bg-slate-800 dark:text-indigo-400 md:mb-0 mb-6",children:[(0,l.jsx)("input",{type:"file",className:"hidden",ref:w,onChange:e=>{let t=e.target.files?.[0];t&&g({type:"attach-file",file:t})}}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(r.A,{size:"small",className:"bg-white/20 dark:text-indigo-400",onClick:()=>O(!0),children:(0,l.jsx)(c.A,{})}),(0,l.jsx)(r.A,{size:"small",className:"bg-white/20 dark:text-indigo-400",onClick:()=>{w.current&&w.current.click()},children:(0,l.jsx)(d.A,{})}),(0,l.jsxs)("div",{className:"relative hidden md:block",children:[(0,l.jsx)(r.A,{size:"small",className:"bg-white/20 dark:text-indigo-400",onClick:()=>g({type:"toggle-emoji-menu"}),children:(0,l.jsx)(x.A,{})}),(0,l.jsx)("div",{className:"absolute bottom-full",children:(0,l.jsx)(u.Ay,{onEmojiClick:q,theme:u.Sx.AUTO,emojiStyle:u.Ai.FACEBOOK,lazyLoadEmojis:!0,suggestedEmojisMode:u.A2.FREQUENT,open:s.isEmojiMenuOpen,reactionsDefaultOpen:!1})})]})]}),(0,l.jsxs)("div",{className:"flex w-full flex-col gap-2",children:[j&&(0,l.jsxs)("div",{className:"flex w-full items-center justify-between gap-2 rounded-md bg-indigo-500/10 p-2 dark:bg-indigo-600/20",children:[(0,l.jsxs)("div",{className:"text-sm text-black dark:text-slate-300",children:[j.body.split("\n").map((e,t)=>(0,l.jsx)("p",{className:"break-words text-sm",children:e},t)),j.fileId&&(0,l.jsx)("span",{className:"text-xs text-slate-400 dark:text-slate-500",children:j.fileName||"Arquivo anexado"})]}),(0,l.jsx)(r.A,{size:"small",className:"bg-white/20 dark:text-indigo-400",onClick:b,children:(0,l.jsx)(m.A,{})})]}),s.sendAsAudio&&s.file?(0,l.jsxs)("div",{className:"flex w-full items-center justify-center gap-2",children:[(0,l.jsx)("audio",{controls:!0,src:URL.createObjectURL(s.file),className:"h-8 max-w-[35rem] flex-grow"}),(0,l.jsx)(r.A,{color:"inherit",onClick:()=>g({type:"remove-file"}),children:(0,l.jsx)(m.A,{})})]}):(0,l.jsxs)("div",{className:"relative w-full",children:[(0,l.jsx)(n.A,{multiline:!0,fullWidth:!0,maxRows:5,size:"small",placeholder:"Mensagem",value:R,onChange:e=>F(e.target.value),inputRef:e=>{C.current=e}}),W&&(0,l.jsx)("div",{className:"absolute bottom-full mb-2 left-0 w-[20rem] max-h-40 overflow-auto rounded-md bg-white shadow-md z-50",children:0===B.length?(0,l.jsx)("div",{className:"p-2 text-sm text-gray-500",children:"Nenhum contato"}):B.map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-2 px-3 py-2 hover:bg-blue-100 cursor-pointer",onClick:()=>{let t=G(e,R,C.current?.selectionStart||0);setTimeout(()=>{C.current?.setSelectionRange(t.cursorPosition,t.cursorPosition),C.current?.focus()},0)},children:[(0,l.jsx)("div",{className:"w-6 h-6 rounded-full bg-indigo-300 text-white text-xs flex items-center justify-center font-semibold",children:e.name[0]}),(0,l.jsx)("span",{className:"text-sm text-gray-800",children:e.name})]},e.userId))})]})]}),(0,l.jsx)(r.A,{size:"small","aria-hidden":0===R.length&&!s.sendAsAudio,className:"bg-white/20 dark:text-indigo-400",disabled:k,onClick:function(){let e=!!s.file,l=!!s.text?.trim();(l||e)&&(console.log("Sending message:",e,l),t(),g({type:"change-text",text:""}),g({type:"remove-file"}),P(""),b(),document.dispatchEvent(new Event("scroll-to-bottom")))},children:(0,l.jsx)(o.A,{})}),(0,l.jsx)("div",{className:"aria-hidden:hidden","aria-hidden":R.length>0||s.sendAsAudio,children:(0,l.jsx)(A,{onAudioRecorded:e=>g({type:"set-audio",file:e})})}),I&&(0,l.jsx)(i.A,{open:!0,onClose:()=>O(!1),children:(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50",children:e&&(0,l.jsx)(D,{chat:e,onClose:()=>O(!1)})})}),E&&(0,l.jsx)(i.A,{open:!0,onClose:()=>M(!1),children:(0,l.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50"})})]})}},34377:(e,t,s)=>{s.d(t,{A:()=>r});var l=s(60687),a=s(2918);function r({text:e}){return(0,l.jsx)(a.A,{options:{defaultProtocol:"https",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline break-words"},children:e})}},45172:(e,t,s)=>{s.d(t,{A:()=>y});var l=s(60687),a=s(6948),r=s(46380),n=s(92245),i=s(72076),o=s(12879),c=s(60042),d=s(83685),x=s(43210),m=s(12039),u=s(60997),h=s(16184),p=s(9134),f=s(52171),g=s(93853);function j(){let{closeModal:e}=(0,x.useContext)(m.BR),{wppApi:t,currentChat:s,updateChatContact:a}=(0,x.useContext)(f.ce),[r,n]=(0,x.useState)(s.contact.name),i=async()=>{if(!s||!t.current||!s.contact)return;let{contact:l}=s;await t.current.updateContact(l.id,r),g.oR.success("Contato atualizado com sucesso!"),a(l.id,r),e()};return(0,l.jsxs)("div",{className:"w-[26rem] rounded-md bg-white text-gray-800 px-4 py-4 dark:bg-slate-800 dark:text-white",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between pb-8",children:[(0,l.jsx)("h1",{className:"text-xl",children:"Editar contato"}),(0,l.jsx)(d.A,{onClick:e,children:(0,l.jsx)(p.A,{})})]}),(0,l.jsxs)("form",{className:"flex flex-col gap-6",children:[(0,l.jsx)(u.A,{label:"Nome",value:r,onChange:e=>n(e.target.value)}),(0,l.jsx)(u.A,{label:"Whatsapp",defaultValue:s.contact.phone,disabled:!0}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)(h.A,{type:"button",variant:"contained",color:"secondary",className:"w-32",onClick:e,children:"Cancelar"}),(0,l.jsx)(h.A,{type:"button",variant:"contained",color:"primary",className:"w-32",onClick:i,children:"SALVAR"})]})]})]})}var b=s(72746);function A(){let{closeModal:e}=(0,x.useContext)(m.BR),{createSchedule:t,currentChat:s}=(0,x.useContext)(f.ce),[a,r]=(0,x.useState)(null);return(0,l.jsxs)("div",{className:"w-[26rem] rounded-md bg-white text-gray-800 px-4 py-4 dark:bg-slate-800 dark:text-white",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between pb-8",children:[(0,l.jsx)("h1",{className:"text-xl",children:"Agendar retorno"}),(0,l.jsx)(d.A,{onClick:e,children:(0,l.jsx)(p.A,{})})]}),(0,l.jsxs)("form",{className:"flex flex-col gap-6",children:[(0,l.jsx)(u.A,{className:"dark:input-dark",type:"datetime-local",required:!0,onChange:e=>{r(new Date(e.currentTarget.value))}}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)(h.A,{type:"button",variant:"contained",color:"secondary",className:"w-32",onClick:e,children:"Cancelar"}),(0,l.jsx)(h.A,{type:"button",variant:"contained",color:"primary",className:"w-32",onClick:()=>{s?.chatType==="wpp"&&a&&(t(s,a),e())},children:"Agendar"})]})]})]})}var N=s(70686),v=s(44366);function y({name:e,avatarUrl:t,customerName:s,phone:u,chatType:h,codErp:p,cpfCnpj:g,customerId:y,startDate:w}){let{openModal:C}=(0,x.useContext)(m.BR),{currentChat:k}=(0,f.jb)();return(0,l.jsxs)("div",{className:"flex items-center justify-between gap-4 border-b bg-slate-200 px-4 py-2 dark:border-none dark:bg-slate-800 md:pt-2 pt-10",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 bg-slate-300 dark:bg-slate-700 rounded-md px-2 py-1",children:[(0,l.jsx)(o.A,{variant:"rounded",alt:e,src:t||"",sx:{width:60,height:60}}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"font-semibold text-slate-800 dark:text-slate-200",children:e}),(0,l.jsx)("h2",{className:"text-sm text-slate-700 dark:text-slate-200",children:s||"Contato N\xe3o Atribu\xeddo"}),(0,l.jsx)("h2",{className:"text-sm text-slate-400 dark:text-slate-300",children:u?v.Formatter.phone(u):""})]})]}),y&&(0,l.jsxs)("div",{className:"bg-slate-300 dark:bg-slate-700 rounded-md px-2 py-1 flex flex-col",children:[(0,l.jsxs)("span",{className:"text-slate-800 dark:text-slate-200 text-sm",children:[(0,l.jsx)("b",{children:"CPF/CNPJ: "}),g||"N/D"]}),(0,l.jsxs)("span",{className:"text-sm text-slate-800 dark:text-slate-200",children:[(0,l.jsx)("b",{children:"C\xf3digo Cliente: "}),y||"N/D"]}),(0,l.jsxs)("span",{className:"text-sm text-slate-800 dark:text-slate-200",children:[(0,l.jsx)("b",{children:"C\xf3digo ERP: "}),p||"N/D"]})]})]}),k?.chatType==="wpp"&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)(c.A,{title:(0,l.jsx)("h3",{className:"text-base dark:text-white",children:"Editar contato"}),children:(0,l.jsx)(d.A,{onClick:()=>{C((0,l.jsx)(j,{}))},children:(0,l.jsx)(r.A,{color:"info"})})}),(0,l.jsx)(c.A,{title:(0,l.jsx)("h3",{className:"text-base dark:text-white",children:"Transferir conversa"}),children:(0,l.jsx)(d.A,{onClick:()=>{C((0,l.jsx)(N.A,{}))},children:(0,l.jsx)(i.A,{color:"secondary"})})}),(0,l.jsx)(c.A,{title:(0,l.jsx)("h3",{className:"text-base dark:text-white",children:"Agendar retorno"}),children:(0,l.jsx)(d.A,{onClick:()=>{C((0,l.jsx)(A,{}))},children:(0,l.jsx)(n.A,{color:"warning"})})}),(0,l.jsx)(c.A,{title:(0,l.jsx)("h3",{className:"text-base dark:text-white",children:"Finalizar conversa"}),children:(0,l.jsx)(d.A,{onClick:()=>{C((0,l.jsx)(b.A,{}))},children:(0,l.jsx)(a.A,{color:"success"})})})]})]})}s(87088),s(97015)},57810:(e,t,s)=>{s.d(t,{A:()=>u});var l=s(60687),a=s(43210),r=s(18157),n=s(93108),i=s(72318),o=s(83685),c=s(8734),d=s(47651),x=s(59390),m=s(34377);function u({id:e,style:t,text:s,date:u,status:h,fileId:p,fileName:f,fileType:g,fileSize:j,groupFirst:b,sentBy:A,quotedMessage:N,onQuote:v,mentionNameMap:y,isForwardMode:w,isSelected:C,onSelect:k,onForward:I,onCopy:O,styleWrapper:E}){let[M,S]=(0,a.useState)(null),R=()=>{S(null)},D=()=>{let e=N?`${N.author||""}: ${N.text}

${s}`:s;O?O():navigator.clipboard.writeText(e)},T=s.replace(/@(\d{8,15})/g,(e,t)=>{let s=t.replace(/\D/g,""),l=y?.get(s);return l?`@${l}`:`@${t}`});return(0,l.jsxs)("li",{id:String(e),style:E,className:`w-full ${n.bj[t]} group flex items-center gap-2 relative`,children:[w&&(0,l.jsx)(i.A,{checked:C,onChange:()=>{k&&k(e)},className:"absolute left-[-12px]"}),(0,l.jsx)("div",{className:`flex flex-col items-center gap-2 p-2 ${n.VU[t]} w-max max-w-[66%] rounded-md`,children:(0,l.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[N&&(0,l.jsxs)("div",{className:`flex w-full flex-col gap-1 rounded-lg mt-2 border-l-2 bg-white/20 dark:bg-slate-300/40 p-2 ${"sent"===N.style?"border-indigo-600":"border-orange-600"}`,children:[(0,l.jsx)("h2",{children:"sent"===N.style?"Voc\xea":N.author||""}),(0,l.jsx)("div",{className:"w-full h-full text-black dark:text-slate-200 p-4 rounded-md",children:N.text.split("\n").map((e,t)=>(0,l.jsx)("p",{className:"max-w-[100%] break-words text-sm",children:(0,l.jsx)(m.A,{text:e})},t))}),N.fileId&&(0,l.jsx)(r.A,{fileId:N.fileId,fileName:N.fileName||"",fileType:N.fileType||"",fileSize:j||""})]}),b&&(0,l.jsx)("h2",{className:"text-xs font-bold text-indigo-300",children:A}),p&&(0,l.jsx)(r.A,{fileId:p,fileName:f||"",fileType:g||"",fileSize:j||""}),(0,l.jsx)("div",{className:"w-full text-slate-900 dark:text-slate-200",children:T.split("\n").map((e,t)=>(0,l.jsx)("p",{className:"max-w-[100%] break-words text-sm",children:(0,l.jsx)(m.A,{text:e})},t))}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["system"!==t&&h&&n.tn[h],(0,l.jsx)("p",{className:"text-xs text-slate-900 dark:text-slate-200",children:u.toLocaleString()})]})]})}),!w&&"system"!==t&&(0,l.jsxs)("div",{className:"invisible group-hover:visible",children:[(0,l.jsx)(o.A,{size:"small",color:"default",title:"Mais op\xe7\xf5es",onClick:e=>{S(e.currentTarget)},children:(0,l.jsx)(x.A,{})}),(0,l.jsxs)(c.A,{anchorEl:M,open:!!M,onClose:R,children:[(0,l.jsx)(d.A,{onClick:()=>{R(),v?.()},children:"Responder"}),(0,l.jsx)(d.A,{onClick:()=>{R(),D()},children:"Copiar"})]})]})]})}},61339:(e,t,s)=>{s.d(t,{U:()=>c,A:()=>d});var l=s(60687),a=s(43210),r=s(52171);function n(e,t){let s=!1,l=!1;switch(t.type){case"change-text":return{...e,text:t.text};case"add-emoji":return{...e,text:e.text+t.emoji};case"attach-file":return{sendAsAudio:l,sendAsDocument:s=!["video","image"].some(e=>t.file.type.includes(e)),text:e.text,file:t.file,isEmojiMenuOpen:!1};case"attach-file-id":return{sendAsAudio:l,sendAsDocument:s,text:e.text,fileId:t.fileId,isEmojiMenuOpen:!1};case"set-audio":return{sendAsAudio:l=!0,sendAsDocument:s,text:e.text,file:t.file,isEmojiMenuOpen:!1};case"remove-file":return{sendAsAudio:l,sendAsDocument:s,text:e.text,isEmojiMenuOpen:!1};case"toggle-emoji-menu":return{...e,isEmojiMenuOpen:!e.isEmojiMenuOpen};case"quote-message":return{...e,quotedId:t.id};case"set-mentions":return{...e,mentions:t.mentions};case"toggle-forward-mode":return{...e,forwardMode:!e.forwardMode,selectedMessages:[]};case"select-message":return{...e,selectedMessages:e.selectedMessages?.includes(t.messageId)?e.selectedMessages.filter(e=>e!==t.messageId):[...e.selectedMessages||[],t.messageId]};case"clear-forward":return{...e,forwardMode:!1,selectedMessages:[]};case"remove-quoted-message":return delete e.quotedId,e;default:return{...e,text:"",file:void 0,fileId:void 0,sendAsAudio:!1,sendAsDocument:!1,isEmojiMenuOpen:!1}}}var i=s(97015);let o={text:"",sendAsAudio:!1,sendAsDocument:!1,isEmojiMenuOpen:!1,forwardMode:!1,selectedMessages:[]},c=(0,a.createContext)({});function d({children:e}){let{sendMessage:t,currentChat:s,messages:d}=(0,a.useContext)(r.ce),{sendInternalMessage:x,messages:m}=(0,a.useContext)(i.xI),[u,h]=(0,a.useReducer)(n,o),[p,f]=(0,a.useState)(null),g=(0,a.useCallback)((e,t,s=!1)=>s?m[e]?.find(e=>e.id===t)||null:d[e]?.find(e=>e.id===t)||null,[d,m]),j=(0,a.useCallback)(e=>{f(e),h({type:"quote-message",id:e.id})},[h]),b=(0,a.useCallback)(()=>{f(null),h({type:"remove-quoted-message"})},[h]);return(0,l.jsx)(c.Provider,{value:{state:u,quotedMessage:p,dispatch:h,sendMessage:()=>{if(s&&"wpp"===s.chatType&&s.contact)try{console.log("Enviando mensagem:",u.file),t(s.contact.phone,{...u,contactId:s.contact.id,chatId:s.id,file:u.file})}catch(e){console.error("Erro inesperado ao chamar sendMessage",e)}s&&"internal"===s.chatType&&x({chatId:s.id,text:u.text,sendAsAudio:u.sendAsAudio,sendAsDocument:u.sendAsDocument,quotedId:u.quotedId,file:u.file,fileId:u.fileId,mentions:u.mentions}),h({type:"reset"})},getMessageById:g,handleQuoteMessage:j,handleQuoteMessageRemove:b},children:e})}},63952:(e,t,s)=>{s.d(t,{A:()=>l});let l=new(s(89193)).FilesClient("https://inpulse.infotecrs.inf.br")},70686:(e,t,s)=>{s.d(t,{A:()=>u});var l=s(60687),a=s(83685),r=s(60997),n=s(47651),i=s(16184),o=s(9134),c=s(43210),d=s(12039),x=s(52171),m=s(97015);function u(){let{closeModal:e}=(0,c.useContext)(d.BR),{currentChat:t,transferAttendance:s}=(0,c.useContext)(x.ce),{users:u}=(0,c.useContext)(m.xI),[h,p]=(0,c.useState)(null);return(0,l.jsxs)("div",{className:"w-[26rem] rounded-md bg-slate-100 text-slate-900 dark:bg-slate-700 dark:text-white px-4 py-4",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between pb-8",children:[(0,l.jsx)("h1",{className:"text-xl",children:"Transferir conversa"}),(0,l.jsx)(a.A,{onClick:e,children:(0,l.jsx)(o.A,{})})]}),(0,l.jsxs)("form",{className:"flex flex-col gap-6",children:[(0,l.jsx)(r.A,{select:!0,label:"Usu\xe1rio",required:!0,value:h??"",onChange:e=>p(Number(e.target.value)),slotProps:{select:{MenuProps:{PaperProps:{className:"scrollbar-whatsapp",style:{maxHeight:248}}}}},children:u?.map(e=>l.jsx(n.A,{value:e.CODIGO,children:e.NOME_EXIBICAO||e.NOME},e.CODIGO))}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)(i.A,{type:"button",variant:"contained",color:"secondary",className:"w-32",onClick:e,children:"Cancelar"}),(0,l.jsx)(i.A,{type:"button",variant:"contained",color:"primary",className:"w-32",disabled:!h,onClick:()=>{h&&t&&(s(t?.id,h),e())},children:"Transferir"})]})]})]})}},72746:(e,t,s)=>{s.d(t,{A:()=>m});var l=s(60687),a=s(83685),r=s(60997),n=s(47651),i=s(16184),o=s(9134),c=s(43210),d=s(12039),x=s(52171);function m(){let{closeModal:e}=(0,c.useContext)(d.BR),{finishChat:t,currentChat:s,wppApi:m}=(0,c.useContext)(x.ce),[u,h]=(0,c.useState)(null),[p,f]=(0,c.useState)([]);return(0,l.jsxs)("div",{className:"w-[26rem] rounded-md bg-white text-gray-800 px-4 py-4 dark:bg-slate-800 dark:text-white",children:[(0,l.jsxs)("header",{className:"flex items-center justify-between pb-8",children:[(0,l.jsx)("h1",{className:"text-xl",children:"Finalizar conversa"}),(0,l.jsx)(a.A,{onClick:e,children:(0,l.jsx)(o.A,{})})]}),(0,l.jsxs)("form",{className:"flex flex-col gap-6",children:[(0,l.jsx)(r.A,{select:!0,label:"Resultado",required:!0,onChange:e=>{let t=e.target.value;h(t?parseInt(t):null)},defaultValue:1,className:"!text-sm",slotProps:{select:{maxRows:5,MenuProps:{PaperProps:{className:"!text-xsm max-w-[12rem] scrollbar-whatsapp",sx:{maxHeight:"20rem"}}}}},children:p.map(e=>(0,l.jsx)(n.A,{value:e.id,children:e.name},`result_${e.id}`))}),(0,l.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,l.jsx)(i.A,{type:"button",variant:"contained",color:"secondary",className:"w-32",onClick:e,children:"Cancelar"}),(0,l.jsx)(i.A,{type:"button",variant:"contained",color:"primary",className:"w-32",onClick:()=>{s&&u&&(t(s.id,u),e())},disabled:!u,children:"Finalizar"})]})]})]})}},78231:(e,t,s)=>{s.d(t,{A:()=>x,_:()=>d});var l=s(60687),a=s(99441),r=s(93108),n=s(43210),i=s(61339),o=s(97015),c=s(30601);function d(e,t){return"system"===e.from?"system":e.from===`user:${t}`?"sent":"received"}function x(){let{currentInternalChatMessages:e,users:t}=(0,n.useContext)(o.xI),{getMessageById:s,handleQuoteMessage:x}=(0,n.useContext)(i.U),{user:m}=(0,c.Z)();return(0,l.jsx)(l.Fragment,{children:e.map(e=>{let n=e.internalChatId&&e.quotedId&&s(e.internalChatId,e.quotedId,!0),i=n?(0,a.A)(n,d(n,m.CODIGO),t):null;return(0,l.jsx)(r.Ay,{id:e.id,style:d(e,m.CODIGO),text:e.body,date:new Date(+e.timestamp),status:e.status,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,fileSize:e.fileSize,quotedMessage:i,onQuote:()=>{x(e)}},`message_${e.id}`)})})}},93108:(e,t,s)=>{s.d(t,{Ay:()=>g,VU:()=>h,bj:()=>p,tn:()=>f});var l=s(60687),a=s(86411),r=s(39060),n=s(8485),i=s(20096),o=s(53768),c=s(43323),d=s(18157),x=s(83685),m=s(37346),u=s(34377);let h={received:"bg-slate-50 text-slate-800 dark:bg-slate-800 dark:text-slate-200 rounded-bl-none",sent:"bg-green-200 text-slate-800 dark:bg-green-800 dark:text-slate-200 rounded-br-none",system:"bg-yellow-200 text-slate-800 dark:bg-yellow-800 dark:text-white"},p={received:"flex-row",sent:"flex-row-reverse",system:"flex-row justify-center"},f={PENDING:(0,l.jsx)(a.A,{className:"text-slate-300"}),SENT:(0,l.jsx)(r.A,{className:"text-slate-300"}),RECEIVED:(0,l.jsx)(n.A,{className:"text-slate-300"}),READ:(0,l.jsx)(n.A,{className:"text-blue-300"}),DOWNLOADED:(0,l.jsx)(i.A,{className:"text-blue-300"}),ERROR:(0,l.jsx)(o.A,{className:"text-red-300"}),REVOKED:(0,l.jsx)(c.A,{className:"text-slate-300"})};function g({id:e,style:t,text:s,date:a,status:r,fileId:n,fileName:i,fileType:o,fileSize:c,quotedMessage:g,onQuote:j}){return(0,l.jsxs)("li",{id:String(e),className:`w-full ${p[t]} group flex items-center gap-2`,children:[(0,l.jsxs)("div",{className:`flex flex-col items-center gap-2 p-2 ${h[t]} w-max max-w-[66%] rounded-md`,children:[g&&(0,l.jsxs)("div",{className:`mt-2 flex w-full flex-col gap-1 rounded-lg border-l-2 bg-white/20 p-2 dark:bg-slate-300/40 ${"sent"===g.style?"border-indigo-600 dark:border-indigo-400":"border-orange-600 dark:border-orange-400"}`,onClick:()=>{let e=document.getElementById(String(g.id));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("bg-indigo-500/5"),setTimeout(()=>{e?.classList.remove("bg-indigo-500/5")},2e3))},children:[(0,l.jsx)("h2",{className:`${"sent"===g.style?"text-indigo-400 dark:text-indigo-600":"text-orange-400 dark:text-orange-600"}`,children:"sent"===g.style?"Voc\xea":g.author||""}),(0,l.jsx)("div",{className:"h-full w-full rounded-md p-4 text-black dark:text-slate-200",children:g.text.split("\n").map((e,t)=>(0,l.jsx)("p",{className:"max-w-[100%] break-words text-sm",children:(0,l.jsx)(u.A,{text:e})},t))}),g.fileId&&(0,l.jsx)(d.A,{fileId:g.fileId,fileName:g.fileName||"",fileType:g.fileType||"",fileSize:c||""})]}),(0,l.jsxs)("div",{className:"flex w-full flex-col gap-1",children:[n&&(0,l.jsx)(d.A,{fileId:n,fileName:i||"",fileType:o||"",fileSize:c||""}),(0,l.jsx)("div",{className:"w-full text-slate-900 dark:text-slate-200",children:s.split("\n").map((e,t)=>(0,l.jsx)("p",{className:"max-w-[100%] break-words text-sm",children:(0,l.jsx)(u.A,{text:e})},t))}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:["system"!==t&&r&&f[r],(0,l.jsx)("p",{className:"text-xs text-slate-900 dark:text-slate-200",children:a.toLocaleString()})]})]})]}),"system"!==t&&(0,l.jsx)(x.A,{className:"invisible group-hover:visible",size:"small",color:"primary",title:"Responder",onClick:j,children:(0,l.jsx)(m.A,{})})]})}},99441:(e,t,s)=>{s.d(t,{A:()=>a});var l=s(44366);function a(e,t,s,a,r){if(!e)return null;let n=null;if(e?.from?.startsWith("user:")){let t=+e.from.split(":")[1],l=s.find(e=>e.CODIGO===t);n=l?l.NOME:null}else if(e?.from?.startsWith("external:")){let t=e.from.split(":"),l=(3===t.length?t[2]:t[1]).split("@")[0].replace(/\D/g,""),a=s.find(e=>e.WHATSAPP===l),i=r?.get(l);n=a?a.NOME:i||l}if(a&&"contactId"in e){let e=a.contact?.phone;n=a.contact?.name||(e?l.Formatter.phone(e):"N/D")}return{id:e.id,style:t,text:e.body,fileId:e.fileId,fileName:e.fileName,fileType:e.fileType,author:n||e.from}}}};